"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.installApp = installApp;
exports.removeApp = removeApp;
exports.launch = launch;
exports.spawn = spawn;
exports.spawnSubProcess = spawnSubProcess;
exports.openUrl = openUrl;
exports.terminate = terminate;
exports.shutdown = shutdown;
exports.createDevice = createDevice;
exports.getAppContainer = getAppContainer;
exports.getScreenshot = getScreenshot;
exports.deleteDevice = deleteDevice;
exports.eraseDevice = eraseDevice;
exports.getDevices = getDevices;
exports.getRuntimeForPlatformVersion = getRuntimeForPlatformVersion;
exports.bootDevice = bootDevice;
exports.setPasteboard = setPasteboard;
exports.getPasteboard = getPasteboard;
exports.addMedia = addMedia;
exports.appInfo = appInfo;
exports.getDeviceTypes = getDeviceTypes;
exports.startBootMonitor = startBootMonitor;
exports.getSimctlList = getSimctlList;
exports.normalizeVersion = normalizeVersion;
exports.getAppearance = getAppearance;
exports.setAppearance = setAppearance;
exports.grantPermission = grantPermission;
exports.revokePermission = revokePermission;
exports.resetPermission = resetPermission;
exports.addRootCertificate = addRootCertificate;
exports.addCertificate = addCertificate;
exports.resetKeychain = resetKeychain;
exports.pushNotification = pushNotification;

require("source-map-support/register");

var _teen_process = require("teen_process");

var _asyncbox = require("asyncbox");

var _appiumSupport = require("appium-support");

var _lodash = _interopRequireDefault(require("lodash"));

var _semver = _interopRequireDefault(require("semver"));

var _path = _interopRequireDefault(require("path"));

const log = _appiumSupport.logger.getLogger('simctl');

const SIM_RUNTIME_NAME = 'com.apple.CoreSimulator.SimRuntime.';
const SIM_RUNTIME_NAME_SUFFIX_IOS = 'iOS';
const DEFAULT_CREATE_SIMULATOR_TIMEOUT = 10000;

async function simCommand(command, timeout, args = [], env = {}, executingFunction = _teen_process.exec, logErrors = true) {
  args = ['simctl', command, ...args];
  env = _lodash.default.defaults(_lodash.default.mapKeys(env, (value, key) => {
    return `SIMCTL_CHILD_${key}`;
  }), process.env);

  try {
    return await executingFunction('xcrun', args, {
      timeout,
      env
    });
  } catch (e) {
    if (!logErrors) {
      throw e;
    } else if (e.stderr) {
      log.errorAndThrow(`simctl error running '${command}': ${e.stderr.trim()}`);
    } else {
      log.errorAndThrow(e);
    }
  }
}

async function simExec(command, timeout, args = [], env = {}, logErrors = true) {
  return await simCommand(command, timeout, args, env, async (c, a, ob) => {
    return await (0, _teen_process.exec)(c, a, ob);
  }, logErrors);
}

async function simSubProcess(command, timeout, args = [], env = {}) {
  return await simCommand(command, timeout, args, env, (c, a, ob) => {
    return new _teen_process.SubProcess(c, a, ob);
  });
}

async function installApp(udid, appPath) {
  await simExec('install', 0, [udid, appPath]);
}

async function bootDevice(udid) {
  try {
    await simExec('boot', 0, [udid]);
  } catch (err) {
    if ((err.message || '').indexOf('Unable to boot device in current state: Booted') === -1) {
      throw err;
    }

    log.debug(`Simulator already in 'Booted' state. Continuing`);
  }
}

async function removeApp(udid, bundleId) {
  await simExec('uninstall', 0, [udid, bundleId]);
}

async function launch(udid, bundleId, tries = 5) {
  await (0, _asyncbox.retryInterval)(tries, 1000, async () => {
    await simExec('launch', 0, [udid, bundleId]);
  });
}

async function spawn(udid, args, env = {}) {
  return await simExec('spawn', 0, [udid, ...(_lodash.default.isArray(args) ? args : [args])], env);
}

async function spawnSubProcess(udid, args, env = {}) {
  return await simSubProcess('spawn', 0, [udid, ...(_lodash.default.isArray(args) ? args : [args])], env);
}

async function openUrl(udid, url) {
  return await simExec('openurl', 0, [udid, url]);
}

async function appInfo(udid, bundleId) {
  const {
    stdout
  } = await simExec('appinfo', 0, [udid, bundleId]);
  return (stdout || '').trim();
}

async function addMedia(udid, path) {
  return await simExec('addmedia', 0, [udid, path]);
}

async function terminate(udid, bundleId) {
  await simExec('terminate', 0, [udid, bundleId]);
}

async function getAppContainer(udid, bundleId, logErrors = true, containerType = null) {
  const args = [udid, bundleId];

  if (containerType) {
    args.push(containerType);
  }

  const {
    stdout
  } = await simExec('get_app_container', 0, args, {}, logErrors);
  return (stdout || '').trim();
}

async function shutdown(udid) {
  try {
    await simExec('shutdown', 0, [udid]);
  } catch (err) {
    if (!(err + '').includes('current state: Shutdown')) {
      throw err;
    }

    log.debug(`Simulator already in 'Shutdown' state. Continuing`);
  }
}

async function createDevice(name, deviceTypeId, platformVersion, opts = {}) {
  const {
    platform = SIM_RUNTIME_NAME_SUFFIX_IOS,
    timeout = DEFAULT_CREATE_SIMULATOR_TIMEOUT
  } = opts;
  let runtimeIds = [];

  try {
    runtimeIds.push((await getRuntimeForPlatformVersionViaJson(platformVersion, platform)));
  } catch (ign) {}

  if (_lodash.default.isEmpty(runtimeIds)) {
    let runtimeId;

    try {
      runtimeId = await getRuntimeForPlatformVersion(platformVersion, platform);
    } catch (err) {
      log.warn(`Unable to find runtime for iOS '${platformVersion}'. Continuing`);
      runtimeId = platformVersion;
    }

    let potentialRuntimeIds = [normalizeVersion(runtimeId)];

    if (runtimeId.split('.').length === 3) {
      potentialRuntimeIds.push(runtimeId);
    }

    runtimeIds.push(...potentialRuntimeIds.map(id => `${SIM_RUNTIME_NAME}${platform}-${id.replace(/\./g, '-')}`), ...potentialRuntimeIds);
  }

  let udid;

  for (const runtimeId of runtimeIds) {
    log.debug(`Creating simulator with name '${name}', device type id '${deviceTypeId}' and runtime id '${runtimeId}'`);

    try {
      const out = await simExec('create', 0, [name, deviceTypeId, runtimeId]);
      udid = out.stdout.trim();
      break;
    } catch (ign) {}
  }

  if (!udid) {
    throw new Error(`Could not create simulator with name '${name}', device ` + `type id '${deviceTypeId}', with runtime ids ` + `${runtimeIds.map(id => `'${id}'`).join(', ')}`);
  }

  const retries = parseInt(timeout / 1000, 10);
  await (0, _asyncbox.retryInterval)(retries, 1000, async () => {
    const devices = _lodash.default.values((await getDevices()));

    for (const deviceArr of _lodash.default.values(devices)) {
      for (const device of deviceArr) {
        if (device.udid === udid) {
          if (device.state === 'Creating') {
            throw new Error(`Device with udid '${udid}' still being created`);
          } else {
            return;
          }
        }
      }
    }

    throw new Error(`Device with udid '${udid}' not yet created`);
  });
  return udid;
}

async function deleteDevice(udid) {
  await simExec('delete', 0, [udid]);
}

async function eraseDevice(udid, timeout = 1000) {
  let loopFn = async () => {
    await simExec('erase', 10000, [udid]);
  };

  let retries = parseInt(timeout / 200, 10);
  await (0, _asyncbox.retryInterval)(retries, 200, loopFn);
}

async function getDevicesByParsing(platform) {
  const {
    stdout
  } = await simExec('list', 0, ['devices']);
  const deviceSectionRe = _lodash.default.isEmpty(platform) ? new RegExp(`\\-\\-\\s+(\\S+)\\s+(\\S+)\\s+\\-\\-(\\n\\s{4}.+)*`, 'mgi') : new RegExp(`\\-\\-\\s+${_lodash.default.escapeRegExp(platform)}\\s+(\\S+)\\s+\\-\\-(\\n\\s{4}.+)*`, 'mgi');
  const matches = [];
  let match;

  while (match = deviceSectionRe.exec(stdout)) {
    matches.push(match);
  }

  if (_lodash.default.isEmpty(matches)) {
    throw new Error('Could not find device section');
  }

  const lineRe = /([^\s].+) \((\w+-.+\w+)\) \((\w+\s?\w+)\)/;
  const devices = {};

  for (match of matches) {
    const sdk = platform ? match[1] : match[2];
    devices[sdk] = devices[sdk] || [];

    for (const line of match[0].split('\n').slice(1)) {
      if (line.includes('(unavailable, ')) {
        continue;
      }

      const lineMatch = lineRe.exec(line);

      if (!lineMatch) {
        throw new Error(`Could not match line: ${line}`);
      }

      devices[sdk].push({
        name: lineMatch[1],
        udid: lineMatch[2],
        state: lineMatch[3],
        sdk,
        platform: platform || match[1]
      });
    }
  }

  return devices;
}

async function getDevices(forSdk, platform) {
  let devices = {};

  try {
    const {
      stdout
    } = await simExec('list', 0, ['devices', '-j']);
    const versionMatchRe = _lodash.default.isEmpty(platform) ? new RegExp(`^([^\\s-]+)[\\s-](\\S+)`, 'i') : new RegExp(`^${_lodash.default.escapeRegExp(platform)}[\\s-](\\S+)`, 'i');

    for (let [sdkName, entries] of _lodash.default.toPairs(JSON.parse(stdout).devices)) {
      sdkName = sdkName.replace(SIM_RUNTIME_NAME, '');
      const versionMatch = versionMatchRe.exec(sdkName);

      if (!versionMatch) {
        continue;
      }

      const sdk = (platform ? versionMatch[1] : versionMatch[2]).replace('-', '.');
      devices[sdk] = devices[sdk] || [];
      devices[sdk].push(...entries.filter(el => _lodash.default.isUndefined(el.isAvailable) || el.isAvailable).map(el => {
        delete el.availability;
        return {
          sdk,
          ...el,
          platform: platform || versionMatch[1]
        };
      }));
    }
  } catch (err) {
    log.debug(`Unable to get JSON device list: ${err.stack}`);
    log.debug('Falling back to manual parsing');
    devices = await getDevicesByParsing(platform);
  }

  if (!forSdk) {
    return devices;
  }

  if (devices[forSdk]) {
    return devices[forSdk];
  }

  let errMsg = `'${forSdk}' does not exist in the list of simctl SDKs.`;

  const availableSDKs = _lodash.default.keys(devices);

  errMsg += availableSDKs.length ? ` Only the following Simulator SDK versions are available on your system: ${availableSDKs.join(', ')}` : ` No Simulator SDK versions are available on your system. Please install some via Xcode preferences.`;
  throw new Error(errMsg);
}

function normalizeVersion(version) {
  const semverVersion = _semver.default.coerce(version);

  if (_lodash.default.isNil(semverVersion)) {
    throw new Error(`Unable to parse version '${version}'`);
  }

  return `${semverVersion.major}.${semverVersion.minor}`;
}

async function getRuntimeForPlatformVersionViaJson(platformVersion, platform = 'iOS') {
  const {
    stdout
  } = await simExec('list', 0, ['runtimes', '--json']);

  for (const {
    version,
    identifier,
    name
  } of JSON.parse(stdout).runtimes) {
    if (normalizeVersion(version) === normalizeVersion(platformVersion) && name.toLowerCase().startsWith(platform.toLowerCase())) {
      return identifier;
    }
  }

  throw new Error(`Could not use --json flag to parse platform version`);
}

async function getRuntimeForPlatformVersion(platformVersion, platform = 'iOS') {
  try {
    const {
      stdout
    } = await simExec('list', 0, ['runtimes']);
    const runtimeRe = new RegExp(`${_lodash.default.escapeRegExp(platform)}\\s+(\\d+\\.\\d+)\\s+\\((\\d+\\.\\d+\\.*\\d*)`, 'i');

    for (const line of stdout.split('\n')) {
      const match = runtimeRe.exec(line);

      if (match && match[1] === platformVersion) {
        return match[2];
      }
    }
  } catch (ign) {}

  return platformVersion;
}

async function getScreenshot(udid) {
  let pathToScreenshotPng = await _appiumSupport.tempDir.path({
    prefix: `screenshot-${udid}`,
    suffix: '.png'
  });
  await simExec('io', 0, [udid, 'screenshot', pathToScreenshotPng]);
  let screenshotImg = await _appiumSupport.fs.readFile(pathToScreenshotPng);
  await _appiumSupport.fs.rimraf(pathToScreenshotPng);
  return screenshotImg.toString('base64');
}

async function setPasteboard(udid, content, encoding = 'utf-8') {
  const pbCopySubprocess = new _teen_process.SubProcess('xcrun', ['simctl', 'pbcopy', udid]);
  await pbCopySubprocess.start(0);
  const exitCodeVerifier = pbCopySubprocess.join();
  const stdin = pbCopySubprocess.proc.stdin;
  stdin.setEncoding(encoding);
  stdin.write(content);
  stdin.end();
  await exitCodeVerifier;
}

async function getPasteboard(udid, encoding = 'utf-8') {
  const args = ['simctl', 'pbpaste', udid];

  try {
    const {
      stdout
    } = await (0, _teen_process.exec)('xcrun', args, {
      timeout: 0,
      encoding
    });
    return stdout;
  } catch (e) {
    if (e.stderr) {
      throw new Error(`Error running 'xcrun ${args.join(' ')}': ${e.stderr.trim()}`);
    }

    throw e;
  }
}

async function getAppearance(udid) {
  const {
    stdout
  } = await simExec('ui', 0, [udid, 'appearance'], {}, true);
  return (stdout || '').trim();
}

async function setAppearance(udid, appearance) {
  await simExec('ui', 0, [udid, 'appearance', appearance], {}, true);
}

async function grantPermission(udid, bundleId, perm) {
  await simExec('privacy', 0, [udid, 'grant', perm, bundleId], {}, true);
}

async function revokePermission(udid, bundleId, perm) {
  await simExec('privacy', 0, [udid, 'revoke', perm, bundleId], {}, true);
}

async function resetPermission(udid, bundleId, perm) {
  await simExec('privacy', 0, [udid, 'reset', perm, bundleId], {}, true);
}

async function addRootCertificate(udid, certPath) {
  await simExec('keychain', 0, [udid, 'add-root-cert', certPath], {}, true);
}

async function addCertificate(udid, certPath) {
  await simExec('keychain', 0, [udid, 'add-cert', certPath], {}, true);
}

async function resetKeychain(udid) {
  await simExec('keychain', 0, [udid, 'reset'], {}, true);
}

async function pushNotification(udid, content) {
  const tmpRoot = await _appiumSupport.tempDir.openDir();

  try {
    const dstPath = _path.default.resolve(tmpRoot, 'apns.json');

    await _appiumSupport.fs.writeFile(dstPath, JSON.stringify(content), 'utf8');
    await simExec('push', 0, [udid, dstPath], {}, true);
  } finally {
    await _appiumSupport.fs.rimraf(tmpRoot);
  }
}

async function getDeviceTypes() {
  try {
    const {
      stdout
    } = await simExec('list', 0, ['devicetypes', '-j']);
    const deviceTypes = JSON.parse(stdout.trim());
    return deviceTypes.devicetypes.map(type => type.name);
  } catch (err) {
    let msg = `Unable to get list of device types: ${err.message}`;

    if (err.stderr) {
      msg = `${msg}. Stderr: ${err.stderr}`;
    }

    throw new Error(msg);
  }
}

async function getSimctlList() {
  try {
    const {
      stdout
    } = await simExec('list', 0, ['-j']);
    return JSON.parse(stdout);
  } catch (err) {
    let msg = `Unable to get simctl list: ${err.message}`;

    if (err.stderr) {
      msg = `${msg}. Stderr: ${err.stderr}`;
    }

    throw new Error(msg);
  }
}

async function startBootMonitor(udid, opts = {}) {
  const {
    timeout = 240000,
    onWaitingDataMigration,
    onWaitingSystemApp,
    onFinished,
    onError
  } = opts;
  let status = '';
  let isBootingFinished = false;
  let error = null;
  let timeoutHandler = null;
  const bootMonitor = await simSubProcess('bootstatus', 0, [udid]);
  bootMonitor.on('output', (stdout, stderr) => {
    status += stdout || stderr;

    if (stdout) {
      if (stdout.includes('Waiting on Data Migration') && onWaitingDataMigration) {
        onWaitingDataMigration();
      } else if (stdout.includes('Waiting on System App') && onWaitingSystemApp) {
        onWaitingSystemApp();
      }
    }
  });
  bootMonitor.on('exit', (code, signal) => {
    if (timeoutHandler) {
      clearTimeout(timeoutHandler);
    }

    if (code === 0) {
      if (onFinished) {
        onFinished();
      }

      isBootingFinished = true;
    } else {
      status = status || signal;
      error = new Error(status);

      if (onError) {
        onError(error);
      }
    }
  });
  await bootMonitor.start(0);

  const stopMonitor = async () => {
    if (bootMonitor.isRunning) {
      try {
        await bootMonitor.stop();
      } catch (e) {
        log.warn(e.message);
      }
    }
  };

  const timer = new _appiumSupport.timing.Timer().start();

  if (onFinished) {
    timeoutHandler = setTimeout(stopMonitor, timeout);
  } else {
    try {
      await (0, _asyncbox.waitForCondition)(() => {
        if (error) {
          throw error;
        }

        return isBootingFinished;
      }, {
        waitMs: timeout,
        intervalMs: 500
      });
    } catch (err) {
      await stopMonitor();
      throw new Error(`The simulator ${udid} has failed to finish booting after ${timer.getDuration().asSeconds.toFixed(3)}s. ` + `Original status: ${status}`);
    }
  }

  return bootMonitor;
}require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9zaW1jdGwuanMiXSwibmFtZXMiOlsibG9nIiwibG9nZ2VyIiwiZ2V0TG9nZ2VyIiwiU0lNX1JVTlRJTUVfTkFNRSIsIlNJTV9SVU5USU1FX05BTUVfU1VGRklYX0lPUyIsIkRFRkFVTFRfQ1JFQVRFX1NJTVVMQVRPUl9USU1FT1VUIiwic2ltQ29tbWFuZCIsImNvbW1hbmQiLCJ0aW1lb3V0IiwiYXJncyIsImVudiIsImV4ZWN1dGluZ0Z1bmN0aW9uIiwiZXhlYyIsImxvZ0Vycm9ycyIsIl8iLCJkZWZhdWx0cyIsIm1hcEtleXMiLCJ2YWx1ZSIsImtleSIsInByb2Nlc3MiLCJlIiwic3RkZXJyIiwiZXJyb3JBbmRUaHJvdyIsInRyaW0iLCJzaW1FeGVjIiwiYyIsImEiLCJvYiIsInNpbVN1YlByb2Nlc3MiLCJTdWJQcm9jZXNzIiwiaW5zdGFsbEFwcCIsInVkaWQiLCJhcHBQYXRoIiwiYm9vdERldmljZSIsImVyciIsIm1lc3NhZ2UiLCJpbmRleE9mIiwiZGVidWciLCJyZW1vdmVBcHAiLCJidW5kbGVJZCIsImxhdW5jaCIsInRyaWVzIiwic3Bhd24iLCJpc0FycmF5Iiwic3Bhd25TdWJQcm9jZXNzIiwib3BlblVybCIsInVybCIsImFwcEluZm8iLCJzdGRvdXQiLCJhZGRNZWRpYSIsInBhdGgiLCJ0ZXJtaW5hdGUiLCJnZXRBcHBDb250YWluZXIiLCJjb250YWluZXJUeXBlIiwicHVzaCIsInNodXRkb3duIiwiaW5jbHVkZXMiLCJjcmVhdGVEZXZpY2UiLCJuYW1lIiwiZGV2aWNlVHlwZUlkIiwicGxhdGZvcm1WZXJzaW9uIiwib3B0cyIsInBsYXRmb3JtIiwicnVudGltZUlkcyIsImdldFJ1bnRpbWVGb3JQbGF0Zm9ybVZlcnNpb25WaWFKc29uIiwiaWduIiwiaXNFbXB0eSIsInJ1bnRpbWVJZCIsImdldFJ1bnRpbWVGb3JQbGF0Zm9ybVZlcnNpb24iLCJ3YXJuIiwicG90ZW50aWFsUnVudGltZUlkcyIsIm5vcm1hbGl6ZVZlcnNpb24iLCJzcGxpdCIsImxlbmd0aCIsIm1hcCIsImlkIiwicmVwbGFjZSIsIm91dCIsIkVycm9yIiwiam9pbiIsInJldHJpZXMiLCJwYXJzZUludCIsImRldmljZXMiLCJ2YWx1ZXMiLCJnZXREZXZpY2VzIiwiZGV2aWNlQXJyIiwiZGV2aWNlIiwic3RhdGUiLCJkZWxldGVEZXZpY2UiLCJlcmFzZURldmljZSIsImxvb3BGbiIsImdldERldmljZXNCeVBhcnNpbmciLCJkZXZpY2VTZWN0aW9uUmUiLCJSZWdFeHAiLCJlc2NhcGVSZWdFeHAiLCJtYXRjaGVzIiwibWF0Y2giLCJsaW5lUmUiLCJzZGsiLCJsaW5lIiwic2xpY2UiLCJsaW5lTWF0Y2giLCJmb3JTZGsiLCJ2ZXJzaW9uTWF0Y2hSZSIsInNka05hbWUiLCJlbnRyaWVzIiwidG9QYWlycyIsIkpTT04iLCJwYXJzZSIsInZlcnNpb25NYXRjaCIsImZpbHRlciIsImVsIiwiaXNVbmRlZmluZWQiLCJpc0F2YWlsYWJsZSIsImF2YWlsYWJpbGl0eSIsInN0YWNrIiwiZXJyTXNnIiwiYXZhaWxhYmxlU0RLcyIsImtleXMiLCJ2ZXJzaW9uIiwic2VtdmVyVmVyc2lvbiIsInNlbXZlciIsImNvZXJjZSIsImlzTmlsIiwibWFqb3IiLCJtaW5vciIsImlkZW50aWZpZXIiLCJydW50aW1lcyIsInRvTG93ZXJDYXNlIiwic3RhcnRzV2l0aCIsInJ1bnRpbWVSZSIsImdldFNjcmVlbnNob3QiLCJwYXRoVG9TY3JlZW5zaG90UG5nIiwidGVtcERpciIsInByZWZpeCIsInN1ZmZpeCIsInNjcmVlbnNob3RJbWciLCJmcyIsInJlYWRGaWxlIiwicmltcmFmIiwidG9TdHJpbmciLCJzZXRQYXN0ZWJvYXJkIiwiY29udGVudCIsImVuY29kaW5nIiwicGJDb3B5U3VicHJvY2VzcyIsInN0YXJ0IiwiZXhpdENvZGVWZXJpZmllciIsInN0ZGluIiwicHJvYyIsInNldEVuY29kaW5nIiwid3JpdGUiLCJlbmQiLCJnZXRQYXN0ZWJvYXJkIiwiZ2V0QXBwZWFyYW5jZSIsInNldEFwcGVhcmFuY2UiLCJhcHBlYXJhbmNlIiwiZ3JhbnRQZXJtaXNzaW9uIiwicGVybSIsInJldm9rZVBlcm1pc3Npb24iLCJyZXNldFBlcm1pc3Npb24iLCJhZGRSb290Q2VydGlmaWNhdGUiLCJjZXJ0UGF0aCIsImFkZENlcnRpZmljYXRlIiwicmVzZXRLZXljaGFpbiIsInB1c2hOb3RpZmljYXRpb24iLCJ0bXBSb290Iiwib3BlbkRpciIsImRzdFBhdGgiLCJyZXNvbHZlIiwid3JpdGVGaWxlIiwic3RyaW5naWZ5IiwiZ2V0RGV2aWNlVHlwZXMiLCJkZXZpY2VUeXBlcyIsImRldmljZXR5cGVzIiwidHlwZSIsIm1zZyIsImdldFNpbWN0bExpc3QiLCJzdGFydEJvb3RNb25pdG9yIiwib25XYWl0aW5nRGF0YU1pZ3JhdGlvbiIsIm9uV2FpdGluZ1N5c3RlbUFwcCIsIm9uRmluaXNoZWQiLCJvbkVycm9yIiwic3RhdHVzIiwiaXNCb290aW5nRmluaXNoZWQiLCJlcnJvciIsInRpbWVvdXRIYW5kbGVyIiwiYm9vdE1vbml0b3IiLCJvbiIsImNvZGUiLCJzaWduYWwiLCJjbGVhclRpbWVvdXQiLCJzdG9wTW9uaXRvciIsImlzUnVubmluZyIsInN0b3AiLCJ0aW1lciIsInRpbWluZyIsIlRpbWVyIiwic2V0VGltZW91dCIsIndhaXRNcyIsImludGVydmFsTXMiLCJnZXREdXJhdGlvbiIsImFzU2Vjb25kcyIsInRvRml4ZWQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFHQSxNQUFNQSxHQUFHLEdBQUdDLHNCQUFPQyxTQUFQLENBQWlCLFFBQWpCLENBQVo7O0FBRUEsTUFBTUMsZ0JBQWdCLEdBQUcscUNBQXpCO0FBQ0EsTUFBTUMsMkJBQTJCLEdBQUcsS0FBcEM7QUFDQSxNQUFNQyxnQ0FBZ0MsR0FBRyxLQUF6Qzs7QUF1QkEsZUFBZUMsVUFBZixDQUEyQkMsT0FBM0IsRUFBb0NDLE9BQXBDLEVB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bnQiOlsiaW1wb3J0IHsgZXhlYywgU3ViUHJvY2VzcyB9IGZyb20gJ3RlZW5fcHJvY2Vzcyc7XG5pbXBvcnQgeyByZXRyeUludGVydmFsLCB3YWl0Rm9yQ29uZGl0aW9uIH0gZnJvbSAnYXN5bmNib3gnO1xuaW1wb3J0IHsgbG9nZ2VyLCBmcywgdGVtcERpciwgdGltaW5nIH0gZnJvbSAnYXBwaXVtLXN1cHBvcnQnO1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCBzZW12ZXIgZnJvbSAnc2VtdmVyJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuXG5cbmNvbnN0IGxvZyA9IGxvZ2dlci5nZXRMb2dnZXIoJ3NpbWN0bCcpO1xuXG5jb25zdCBTSU1fUlVOVElNRV9OQU1FID0gJ2NvbS5hcHBsZS5Db3JlU2ltdWxhdG9yLlNpbVJ1bnRpbWUuJztcbmNvbnN0IFNJTV9SVU5USU1FX05BTUVfU1VGRklYX0lPUyA9ICdpT1MnO1xuY29uc3QgREVGQVVMVF9DUkVBVEVfU0lNVUxBVE9SX1RJTUVPVVQgPSAxMDAwMDtcblxuLyoqXG4gKiBFeGVjdXRlIHRoZSBwYXJ0aWN1bGFyIHNpbWN0bCBjb21tYW5kIGFuZCByZXR1cm4gdGhlIG91dHB1dC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gY29tbWFuZCAtIE9uZSBvZiBhdmFpbGFibGUgc2ltY3RsIHN1YmNvbW1hbmRzLlxuICogICAgICAgICAgICAgICAgICAgICAgICAgICBFeGVjdXRlIGB4Y3J1biBzaW1jdGxgIGluIFRlcm1pbmFsIHRvIHNlZSB0aGUgZnVsbCBsaXN0XG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mIGF2YWlsYWJsZSBzdWJjb21tYW5kcy5cbiAqIEBwYXJhbSB7bnVtYmVyfSB0aW1lb3V0IC0gQ29tbWFuZCBleGVjdXRpb24gdGltZW91dCBpbiBtaWxsaXNlY29uZHMuXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgIFNldCBpdCB0byB6ZXJvIHRvIHNraXAgd2FpdGluZyBmb3IgY29tbWFuZFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICBleGVjdXRpb24uXG4gKiBAcGFyYW0ge0FycmF5LjxzdHJpbmc+fSBhcmdzIFtbXV0gLSBUaGUgbGlzdCBvZiBhZGRpdGlvbmFsIHN1YmNvbW1hbmQgYXJndW1lbnRzLlxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSXQncyBlbXB0eSBieSBkZWZhdWx0LlxuICogQHBhcmFtIHtPYmplY3R9IGVudiBbe31dIC0gRW52aXJvbm1lbnQgdmFyaWFibGVzIG1hcHBpbmcuIEFsbCB0aGVzZSB2YXJpYWJsZXNcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbGwgYmUgcGFzc2VkIFNpbXVsYXRvciBhbmQgdXNlZCBpbiBfZXhlY3V0aW5nRnVuY3Rpb25fLlxuICogQHBhcmFtIHtGdW5jdGlvbn0gZXhlY3V0aW5nRnVuY3Rpb24gLSBFeGVjdXRpbmcgZnVuY3Rpb24gb2JqZWN0LiBFcXVhbHMgdG8gdGVlbl9wcm9jZXNzJ3NcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2V4ZWNfIGJ5IGRlZmF1bHQuXG4gKiBAcGFyYW0ge2Jvb2xlYW59IGxvZ0Vycm9ycyBbdHJ1ZV0gLSBTZXQgaXQgdG8gX2ZhbHNlXyB0byB0aHJvdyBleGVjdXRpb24gZXJyb3JzXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbW1lZGlhdGVseSB3aXRob3V0IGxvZ2dpbmcgYW55IGFkZGl0aW9uYWwgaW5mb3JtYXRpb24uXG4gKiBAcmV0dXJuIHtPYmplY3R9IFRoZSByZXN1bHQgb2YgX2V4ZWN1dGluZ0Z1bmN0aW9uXy5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgc2ltY3RsIHN1YmNvbW1hbmQgY29tbWFuZCBleGVjdXRlZCBieSBfZXhlY3V0aW5nRnVuY3Rpb25fXG4gKiAgICAgICAgICAgICAgICAgcmV0dXJucyBub24temVybyByZXR1cm4gY29kZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gc2ltQ29tbWFuZCAoY29tbWFuZCwgdGltZW91dCwgYXJncyA9IFtdLCBlbnYgPSB7fSwgZXhlY3V0aW5nRnVuY3Rpb24gPSBleGVjLCBsb2dFcnJvcnMgPSB0cnVlKSB7XG4gIC8vIHJ1biBhIHBhcnRpY3VsYXIgc2ltY3RsIGNvbW1hbmRcbiAgYXJncyA9IFsnc2ltY3RsJywgY29tbWFuZCwgLi4uYXJnc107XG4gIC8vIFByZWZpeCBhbGwgcGFzc2VkIGluIGVudmlyb25tZW50IHZhcmlhYmxlcyB3aXRoICdTSU1DVExfQ0hJTERfJywgc2ltY3RsXG4gIC8vIHdpbGwgdGhlbiBwYXNzIHRoZXNlIHRvIHRoZSBjaGlsZCAoc3Bhd25lZCkgcHJvY2Vzcy5cbiAgZW52ID0gXy5kZWZhdWx0cyhfLm1hcEtleXMoZW52LCAodmFsdWUsIGtleSkgPT4ge1xuICAgIHJldHVybiBgU0lNQ1RMX0NISUxEXyR7a2V5fWA7XG4gIH0pLCBwcm9jZXNzLmVudik7XG5cbiAgdHJ5IHtcbiAgICByZXR1cm4gYXdhaXQgZXhlY3V0aW5nRnVuY3Rpb24oJ3hjcnVuJywgYXJncywge3RpbWVvdXQsIGVudn0pO1xuICB9IGNhdGNoIChlKSB7XG4gICAgaWYgKCFsb2dFcnJvcnMpIHtcbiAgICAgIC8vIGlmIHdlIGRvbid0IHdhbnQgdG8gc2VlIHRoZSBlcnJvcnMsIGp1c3QgdGhyb3cgYW5kIGFsbG93IHRoZSBjYWxsaW5nXG4gICAgICAvLyBjb2RlIGRvIHdoYXQgaXQgd2FudHNcbiAgICAgIHRocm93IGU7XG4gICAgfSBlbHNlIGlmIChlLnN0ZGVycikge1xuICAgICAgbG9nLmVycm9yQW5kVGhyb3coYHNpbWN0bCBlcnJvciBydW5uaW5nICcke2NvbW1hbmR9JzogJHtlLnN0ZGVyci50cmltKCl9YCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxvZy5lcnJvckFuZFRocm93KGUpO1xuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IEV4ZWNSZXN1bHRcbiAqIEBwcm9wZXJ0eSB7P3N0cmluZ30gc3Rkb3V0IC0gUHJvY2VzcyBzdGRvdXQuXG4gKiBAcHJvcGVydHkgez9zdHJpbmd9IHN0ZGVyciAtIFByb2Nlc3Mgc3RkZXJyLlxuICogQHByb3BlcnR5IHtudW1iZXJ9IGNvZGUgLSBQcm9jZXNzIGV4aXQgY29kZS5cbiAqL1xuXG4vKipcbiAqIEV4ZWN1dGUgdGhlIHBhcnRpY3VsYXIgc2ltY3RsIHN1YmNvbW1hbmQgc3luY2hyb25vdXNseSBhbmRcbiAqIHdhaXQgZm9yIHRoZSBvdXRwdXQuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGNvbW1hbmQgLSBTZWUge0BsaW5rIHNpbUNvbW1hbmR9IHBhcmFtZXRlcnMuXG4gKiBAcGFyYW0ge251bWJlcn0gdGltZW91dCAtIFNlZSB7QGxpbmsgc2ltQ29tbWFuZH0gcGFyYW1ldGVycy5cbiAqIEBwYXJhbSB7QXJyYXkuPHN0cmluZz59IGFyZ3MgW1tdXSAtIFNlZSB7QGxpbmsgc2ltQ29tbWFuZH0gcGFyYW1ldGVycy5cbiAqIEBwYXJhbSB7T2JqZWN0fSBlbnYgW3t9XSAtIFNlZSB7QGxpbmsgc2ltQ29tbWFuZH0gcGFyYW1ldGVycy5cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gbG9nRXJyb3JzIFt0cnVlXSAtIFNlZSB7QGxpbmsgc2ltQ29tbWFuZH0gcGFyYW1ldGVycy5cbiAqIEByZXR1cm4ge0V4ZWNSZXN1bHR9IFRoZSByZXN1bHQgb2YgX2V4ZWNfIGZ1bmN0aW9uLlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBzaW1jdGwgc3ViY29tbWFuZCBjb21tYW5kIGV4ZWN1dGVkIGJ5IGV4ZWNcbiAqICAgICAgICAgICAgICAgICByZXR1cm5zIG5vbi16ZXJvIHJldHVybiBjb2RlLlxuICovXG5hc3luYyBmdW5jdGlvbiBzaW1FeGVjIChjb21tYW5kLCB0aW1lb3V0LCBhcmdzID0gW10sIGVudiA9IHt9LCBsb2dFcnJvcnMgPSB0cnVlKSB7XG4gIHJldHVybiBhd2FpdCBzaW1Db21tYW5kKGNvbW1hbmQsIHRpbWVvdXQsIGFyZ3MsIGVudiwgYXN5bmMgKGMsIGEsIG9iKSA9PiB7XG4gICAgcmV0dXJuIGF3YWl0IGV4ZWMoYywgYSwgb2IpO1xuICB9LCBsb2dFcnJvcnMpO1xufVxuXG4vKipcbiAqIENyYXRlIGEgdGVlbl9wcm9jZXNzJ3MgU3ViUHJvY2VzcyBpbnN0YW5jZSBmb3IgdGhlIHBhcnRpY3VsYXJcbiAqIHNpbWN0bCBzdWJjb21tYW5kIGV4ZWN1dGlvbi4gVGhpcyBtaWdodCBiZSBuZWVkZWQgdG8gZ2FpbiBiZXR0ZXJcbiAqIGNvbnRyb2wgb3ZlciB0aGUgZXhlY3V0aW9uIHByb2Nlc3MuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGNvbW1hbmQgLSBTZWUge0BsaW5rIHNpbUNvbW1hbmR9IHBhcmFtZXRlcnMuXG4gKiBAcGFyYW0ge251bWJlcn0gdGltZW91dCAtIFNlZSB7QGxpbmsgc2ltQ29tbWFuZH0gcGFyYW1ldGVycy5cbiAqIEBwYXJhbSB7QXJyYXkuPHN0cmluZz59IGFyZ3MgW1tdXSAtIFNlZSB7QGxpbmsgc2ltQ29tbWFuZH0gcGFyYW1ldGVycy5cbiAqIEBwYXJhbSB7T2JqZWN0fSBlbnYgW3t9XSAtIFNlZSB7QGxpbmsgc2ltQ29tbWFuZH0gcGFyYW1ldGVycy5cbiAqIEByZXR1cm4ge1N1YlByb2Nlc3N9IFRoZSBpbnN0YW5jZSBvZiB0ZWVuX3Byb2Nlc3MncyBTdWJQcm9jZXNzIGNsYXNzLlxuICovXG5hc3luYyBmdW5jdGlvbiBzaW1TdWJQcm9jZXNzIChjb21tYW5kLCB0aW1lb3V0LCBhcmdzID0gW10sIGVudiA9IHt9KSB7XG4gIHJldHVybiBhd2FpdCBzaW1Db21tYW5kKGNvbW1hbmQsIHRpbWVvdXQsIGFyZ3MsIGVudiwgKGMsIGEsIG9iKSA9PiB7XG4gICAgcmV0dXJuIG5ldyBTdWJQcm9jZXNzKGMsIGEsIG9iKTtcbiAgfSk7XG59XG5cbi8qKlxuICogSW5zdGFsbCB0aGUgcGFydGljdWxhciBhcHBsaWNhdGlvbiBwYWNrYWdlIG9uIFNpbXVsYXRvci5cbiAqIEl0IGlzIHJlcXVpcmVkIHRoYXQgU2ltdWxhdG9yIGlzIGluIF9ib290ZWRfIHN0YXRlLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSB1ZGlkIC0gVGhlIFVESUQgb2YgYW4gZXhpc3RpbmcgU2ltdWxhdG9yLlxuICogQHBhcmFtIHtzdHJpbmd9IGFwcFBhdGggLSBGdWxsIHBhdGggdG8gLmFwcCBwYWNrYWdlLCB3aGljaCBpc1xuICogICAgICAgICAgICAgICAgICAgICAgICAgICBnb2luZyB0byBiZSBpbnN0YWxsZWQuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIGNvcnJlc3BvbmRpbmcgc2ltY3RsIHN1YmNvbW1hbmQgY29tbWFuZFxuICogICAgICAgICAgICAgICAgIHJldHVybnMgbm9uLXplcm8gcmV0dXJuIGNvZGUuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGluc3RhbGxBcHAgKHVkaWQsIGFwcFBhdGgpIHtcbiAgYXdhaXQgc2ltRXhlYygnaW5zdGFsbCcsIDAsIFt1ZGlkLCBhcHBQYXRoXSk7XG59XG5cbi8qKlxuICogQm9vdCB0aGUgcGFydGljdWxhciBTaW11bGF0b3IgaWYgaXQgaXMgbm90IHJ1bm5pbmcuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVkaWQgLSBUaGUgVURJRCBvZiBhbiBleGlzdGluZyBTaW11bGF0b3IuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIGNvcnJlc3BvbmRpbmcgc2ltY3RsIHN1YmNvbW1hbmQgY29tbWFuZFxuICogICAgICAgICAgICAgICAgIHJldHVybnMgbm9uLXplcm8gcmV0dXJuIGNvZGUuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGJvb3REZXZpY2UgKHVkaWQpIHtcbiAgdHJ5IHtcbiAgICBhd2FpdCBzaW1FeGVjKCdib290JywgMCwgW3VkaWRdKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgaWYgKChlcnIubWVzc2FnZSB8fCAnJykuaW5kZXhPZignVW5hYmxlIHRvIGJvb3QgZGV2aWNlIGluIGN1cnJlbnQgc3RhdGU6IEJvb3RlZCcpID09PSAtMSkge1xuICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbiAgICBsb2cuZGVidWcoYFNpbXVsYXRvciBhbHJlYWR5IGluICdCb290ZWQnIHN0YXRlLiBDb250aW51aW5nYCk7XG4gIH1cbn1cblxuLyoqXG4gKiBSZW1vdmUgdGhlIHBhcnRpY3VsYXIgYXBwbGljYXRpb24gcGFja2FnZSBmcm9tIFNpbXVsYXRvci5cbiAqIEl0IGlzIHJlcXVpcmVkIHRoYXQgU2ltdWxhdG9yIGlzIGluIF9ib290ZWRfIHN0YXRlIGFuZFxuICogdGhlIGFwcGxpY2F0aW9uIHdpdGggZ2l2ZW4gYnVuZGxlIGlkZW50aWZpZXIgaXMgYWxyZWFkeSBpbnN0YWxsZWQuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVkaWQgLSBUaGUgVURJRCBvZiBhbiBleGlzdGluZyBTaW11bGF0b3IuXG4gKiBAcGFyYW0ge3N0cmluZ30gYnVuZGxlSWQgLSBCdW5kbGUgaWRlbnRpZmllciBvZiB0aGUgYXBwbGljYXRpb24sXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGljaCBpcyBnb2luZyB0byBiZSByZW1vdmVkLlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBjb3JyZXNwb25kaW5nIHNpbWN0bCBzdWJjb21tYW5kIGNvbW1hbmRcbiAqICAgICAgICAgICAgICAgICByZXR1cm5zIG5vbi16ZXJvIHJldHVybiBjb2RlLlxuICovXG5hc3luYyBmdW5jdGlvbiByZW1vdmVBcHAgKHVkaWQsIGJ1bmRsZUlkKSB7XG4gIGF3YWl0IHNpbUV4ZWMoJ3VuaW5zdGFsbCcsIDAsIFt1ZGlkLCBidW5kbGVJZF0pO1xufVxuXG4vKipcbiAqIEV4ZWN1dGUgdGhlIHBhcnRpY3VsYXIgYXBwbGljYXRpb24gcGFja2FnZSBvbiBTaW11bGF0b3IuXG4gKiBJdCBpcyByZXF1aXJlZCB0aGF0IFNpbXVsYXRvciBpcyBpbiBfYm9vdGVkXyBzdGF0ZSBhbmRcbiAqIHRoZSBhcHBsaWNhdGlvbiB3aXRoIGdpdmVuIGJ1bmRsZSBpZGVudGlmaWVyIGlzIGFscmVhZHkgaW5zdGFsbGVkLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSB1ZGlkIC0gVGhlIFVESUQgb2YgYW4gZXhpc3RpbmcgU2ltdWxhdG9yLlxuICogQHBhcmFtIHtzdHJpbmd9IGJ1bmRsZUlkIC0gQnVuZGxlIGlkZW50aWZpZXIgb2YgdGhlIGFwcGxpY2F0aW9uLFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpY2ggaXMgZ29pbmcgdG8gYmUgcmVtb3ZlZC5cbiAqIEBwYXJhbSB7bnVtYmVyfSB0cmllcyBbNV0gLSBUaGUgbWF4aW11bSBudW1iZXIgb2YgcmV0cmllcyBiZWZvcmVcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvd2luZyBhbiBleGNlcHRpb24uXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIGNvcnJlc3BvbmRpbmcgc2ltY3RsIHN1YmNvbW1hbmQgY29tbWFuZFxuICogICAgICAgICAgICAgICAgIHJldHVybnMgbm9uLXplcm8gcmV0dXJuIGNvZGUuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGxhdW5jaCAodWRpZCwgYnVuZGxlSWQsIHRyaWVzID0gNSkge1xuICBhd2FpdCByZXRyeUludGVydmFsKHRyaWVzLCAxMDAwLCBhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgc2ltRXhlYygnbGF1bmNoJywgMCwgW3VkaWQsIGJ1bmRsZUlkXSk7XG4gIH0pO1xufVxuXG4vKipcbiAqIFNwYXduIHRoZSBwYXJ0aWN1bGFyIHByb2Nlc3Mgb24gU2ltdWxhdG9yLlxuICogSXQgaXMgcmVxdWlyZWQgdGhhdCBTaW11bGF0b3IgaXMgaW4gX2Jvb3RlZF8gc3RhdGUuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVkaWQgLSBUaGUgVURJRCBvZiBhbiBleGlzdGluZyBTaW11bGF0b3IuXG4gKiBAcGFyYW0ge3N0cmluZ3xBcnJheTxzdHJpbmc+fSBhcmdzIC0gU3Bhd24gYXJndW1lbnRzXG4gKiBAcGFyYW0ge29iamVjdH0gZW52IFt7fV0gLSBBZGRpdGlvbmFsIGVudmlyb25tZW50IHZhcmlhYmxlcyBtYXBwaW5nLlxuICogQHJldHVybiB7RXhlY1Jlc3VsdH0gQ29tbWFuZCBleGVjdXRpb24gcmVzdWx0LlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBjb3JyZXNwb25kaW5nIHNpbWN0bCBzdWJjb21tYW5kIGNvbW1hbmRcbiAqICAgICAgICAgICAgICAgICByZXR1cm5zIG5vbi16ZXJvIHJldHVybiBjb2RlLlxuICovXG5hc3luYyBmdW5jdGlvbiBzcGF3biAodWRpZCwgYXJncywgZW52ID0ge30pIHtcbiAgcmV0dXJuIGF3YWl0IHNpbUV4ZWMoJ3NwYXduJywgMCwgW3VkaWQsIC4uLihfLmlzQXJyYXkoYXJncykgPyBhcmdzIDogW2FyZ3NdKV0sIGVudik7XG59XG5cbi8qKlxuICogUHJlcGFyZSBTdWJQcm9jZXNzIGluc3RhbmNlIGZvciBhIG5ldyBwcm9jZXNzLCB3aGljaCBpcyBnb2luZyB0byBiZSBzcGF3bmVkXG4gKiBvbiBTaW11bGF0b3IuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVkaWQgLSBUaGUgVURJRCBvZiBhbiBleGlzdGluZyBTaW11bGF0b3IuXG4gKiBAcGFyYW0ge3N0cmluZ3xBcnJheTxzdHJpbmc+fSBhcmdzIC0gU3Bhd24gYXJndW1lbnRzXG4gKiBAcGFyYW0ge29iamVjdH0gZW52IFt7fV0gLSBBZGRpdGlvbmFsIGVudmlyb25tZW50IHZhcmlhYmxlcyBtYXBwaW5nLlxuICogQHJldHVybiB7U3ViUHJvY2Vzc30gVGhlIGluc3RhbmNlIG9mIHRoZSBwcm9jZXNzIHRvIGJlIHNwYXduZWQuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHNwYXduU3ViUHJvY2VzcyAodWRpZCwgYXJncywgZW52ID0ge30pIHtcbiAgcmV0dXJuIGF3YWl0IHNpbVN1YlByb2Nlc3MoJ3NwYXduJywgMCwgW3VkaWQsIC4uLihfLmlzQXJyYXkoYXJncykgPyBhcmdzIDogW2FyZ3NdKV0sIGVudik7XG59XG5cbi8qKlxuICogT3BlbiBVUkwgc2NoZW1lIG9uIFNpbXVsYXRvci4gaU9TIHdpbGwgYXV0b21hdGljYWxseSB0cnlcbiAqIHRvIGZpbmQgYSBtYXRjaGluZyBhcHBsaWNhdGlvbiwgd2hpY2ggc3VwcG9ydHMgdGhlIGdpdmVuIHNjaGVtZS5cbiAqIEl0IGlzIHJlcXVpcmVkIHRoYXQgU2ltdWxhdG9yIGlzIGluIF9ib290ZWRfIHN0YXRlLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSB1ZGlkIC0gVGhlIFVESUQgb2YgYW4gZXhpc3RpbmcgU2ltdWxhdG9yLlxuICogQHBhcmFtIHtzdHJpbmd9IHVybCAtIFRoZSBVUkwgc2NoZW1lIHRvIG9wZW4sIGZvciBleGFtcGxlIGh0dHA6Ly9hcHBpb20uaW9cbiAqICAgICAgICAgICAgICAgICAgICAgICB3aWxsIGJlIG9wZW5lZCBieSB0aGUgYnVpbHQtaW4gbW9iaWxlIGJyb3dzZXIuXG4gKiBAcmV0dXJuIHtFeGVjUmVzdWx0fSBDb21tYW5kIGV4ZWN1dGlvbiByZXN1bHQuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIGNvcnJlc3BvbmRpbmcgc2ltY3RsIHN1YmNvbW1hbmQgY29tbWFuZFxuICogICAgICAgICAgICAgICAgIHJldHVybnMgbm9uLXplcm8gcmV0dXJuIGNvZGUuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIG9wZW5VcmwgKHVkaWQsIHVybCkge1xuICByZXR1cm4gYXdhaXQgc2ltRXhlYygnb3BlbnVybCcsIDAsIFt1ZGlkLCB1cmxdKTtcbn1cblxuLyoqXG4gKiBJbnZva2UgaGlkZGVuIGFwcGluZm8gc3ViY29tbWFuZCB0byBnZXQgdGhlIGluZm9ybWF0aW9uXG4gKiBhYm91dCBhcHBsaWNhdGlvbnMgaW5zdGFsbGVkIG9uIFNpbXVsYXRvciwgaW5jbHVkaW5nXG4gKiBzeXN0ZW0gYXBwbGljYXRpb25zICh7QGxpbmsgZ2V0QXBwQ29udGFpbmVyfSBkb2VzIG5vdCBcInNlZVwiIHN1Y2ggYXBwcykuXG4gKiBTaW11bGF0b3Igc2VydmVyIHNob3VsZCBiZSBpbiAnYm9vdGVkJyBzdGF0ZSBmb3IgdGhpcyBjYWxsIHRvIHdvcmsgcHJvcGVybHkuXG4gKiBUaGUgdG9vbCBpcyBvbmx5IGF2YWlsYWJsZSBzaW5jZSBYY29kZSBTREsgOC4xXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVkaWQgLSBVRElEIG9mIHRoZSB0YXJnZXQgU2ltdWxhdG9yLlxuICogQHBhcmFtIHtzdHJpbmd9IGJ1bmRsZUlkIC0gVGhlIGJ1bmRsZSBpZGVudGlmaWVyIG9mIHRoZSB0YXJnZXQgYXBwbGljYXRpb24uXG4gKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBpbmZvcm1hdGlvbiBhYm91dCBpbnN0YWxsZWQgYXBwbGljYXRpb24uXG4gKlxuICogRXhhbXBsZSBvdXRwdXQgZm9yIG5vbi1leGlzdGluZyBhcHBsaWNhdGlvbiBjb250YWluZXI6XG4gKiA8cHJlPlxuICoge1xuICogICBDRkJ1bmRsZUlkZW50aWZpZXIgPSBcImNvbS5hcHBsZS5Nb2JpbGVTYWZhcmlcIjtcbiAqICAgR3JvdXBDb250YWluZXJzID0gICAgIHtcbiAqICAgfTtcbiAqICAgU0JBcHBUYWdzID0gICAgIChcbiAqICAgKTtcbiAqIH1cbiAqIDwvcHJlPlxuICpcbiAqIEV4YW1wbGUgb3V0cHV0IGZvciBhbiBleGlzdGluZyBzeXN0ZW0gYXBwbGljYXRpb24gY29udGFpbmVyOlxuICogPHByZT5cbiAqIHtcbiAqICAgQXBwbGljYXRpb25UeXBlID0gSGlkZGVuO1xuICogICBCdW5kbGUgPSBcImZpbGU6Ly8vQXBwbGljYXRpb25zL1hjb2RlLWJldGEuYXBwL0NvbnRlbnRzL0RldmVsb3Blci9QbGF0Zm9ybXMvaVBob25lT1MucGxhdGZvcm0vRGV2ZWxvcGVyL0xpYnJhcnkvQ29yZVNpbXVsYXRvci9Qcm9maWxlcy9SdW50aW1lcy9pT1Muc2ltcnVudGltZS9Db250ZW50cy9SZXNvdXJjZXMvUnVudGltZVJvb3QvU3lzdGVtL0xpYnJhcnkvQ29yZVNlcnZpY2VzL1NwcmluZ0JvYXJkLmFwcFwiO1xuICogICBDRkJ1bmRsZURpc3BsYXlOYW1lID0gU3ByaW5nQm9hcmQ7XG4gKiAgIENGQnVuZGxlRXhlY3V0YWJsZSA9IFNwcmluZ0JvYXJkO1xuICogICBDRkJ1bmRsZUlkZW50aWZpZXIgPSBcImNvbS5hcHBsZS5zcHJpbmdib2FyZFwiO1xuICogICBDRkJ1bmRsZU5hbWUgPSBTcHJpbmdCb2FyZDtcbiAqICAgQ0ZCdW5kbGVWZXJzaW9uID0gNTA7XG4gKiAgIEdyb3VwQ29udGFpbmVycyA9ICAgICB7XG4gKiAgIH07XG4gKiAgIFBhdGggPSBcIi9BcHBsaWNhdGlvbnMvWGNvZGUtYmV0YS5hcHAvQ29udGVudHMvRGV2ZWxvcGVyL1BsYXRmb3Jtcy9pUGhvbmVPUy5wbGF0Zm9ybS9EZXZlbG9wZXIvTGlicmFyeS9Db3JlU2ltdWxhdG9yL1Byb2ZpbGVzL1J1bnRpbWVzL2lPUy5zaW1ydW50aW1lL0NvbnRlbnRzL1Jlc291cmNlcy9SdW50aW1lUm9vdC9TeXN0ZW0vTGlicmFyeS9Db3JlU2VydmljZXMvU3ByaW5nQm9hcmQuYXBwXCI7XG4gKiAgIFNCQXBwVGFncyA9ICAgICAoXG4gKiAgICk7XG4gKiB9XG4gKiA8L3ByZT5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gYXBwSW5mbyAodWRpZCwgYnVuZGxlSWQpIHtcbiAgY29uc3Qge3N0ZG91dH0gPSBhd2FpdCBzaW1FeGVjKCdhcHBpbmZvJywgMCwgW3VkaWQsIGJ1bmRsZUlkXSk7XG4gIHJldHVybiAoc3Rkb3V0IHx8ICcnKS50cmltKCk7XG59XG5cbi8qKlxuICogQWRkIHRoZSBwYXJ0aWN1bGFyIG1lZGlhIGZpbGUgdG8gU2ltdWxhdG9yJ3MgbGlicmFyeS5cbiAqIEl0IGlzIHJlcXVpcmVkIHRoYXQgU2ltdWxhdG9yIGlzIGluIF9ib290ZWRfIHN0YXRlLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSB1ZGlkIC0gVGhlIFVESUQgb2YgYW4gZXhpc3RpbmcgU2ltdWxhdG9yLlxuICogQHBhcmFtIHtzdHJpbmd9IHBhdGggLSBGdWxsIHBhdGggdG8gYSBtZWRpYSBmaWxlIG9uIHRoZSBsb2NhbFxuICogICAgICAgICAgICAgICAgICAgICAgICBmaWxlIHN5c3RlbS5cbiAqIEByZXR1cm4ge0V4ZWNSZXN1bHR9IENvbW1hbmQgZXhlY3V0aW9uIHJlc3VsdC5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgY29ycmVzcG9uZGluZyBzaW1jdGwgc3ViY29tbWFuZCBjb21tYW5kXG4gKiAgICAgICAgICAgICAgICAgcmV0dXJucyBub24temVybyByZXR1cm4gY29kZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gYWRkTWVkaWEgKHVkaWQsIHBhdGgpIHtcbiAgcmV0dXJuIGF3YWl0IHNpbUV4ZWMoJ2FkZG1lZGlhJywgMCwgW3VkaWQsIHBhdGhdKTtcbn1cblxuLyoqXG4gKiBUZXJtaW5hdGUgdGhlIGdpdmVuIHJ1bm5pbmcgYXBwbGljYXRpb24gb24gU2ltdWxhdG9yLlxuICogSXQgaXMgcmVxdWlyZWQgdGhhdCBTaW11bGF0b3IgaXMgaW4gX2Jvb3RlZF8gc3RhdGUuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVkaWQgLSBUaGUgVURJRCBvZiBhbiBleGlzdGluZyBTaW11bGF0b3IuXG4gKiBAcGFyYW0ge3N0cmluZ30gYnVuZGxlSWQgLSBCdW5kbGUgaWRlbnRpZmllciBvZiB0aGUgYXBwbGljYXRpb24sXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGljaCBpcyBnb2luZyB0byBiZSB0ZXJtaW5hdGVkLlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBjb3JyZXNwb25kaW5nIHNpbWN0bCBzdWJjb21tYW5kIGNvbW1hbmRcbiAqICAgICAgICAgICAgICAgICByZXR1cm5zIG5vbi16ZXJvIHJldHVybiBjb2RlLlxuICovXG5hc3luYyBmdW5jdGlvbiB0ZXJtaW5hdGUgKHVkaWQsIGJ1bmRsZUlkKSB7XG4gIGF3YWl0IHNpbUV4ZWMoJ3Rlcm1pbmF0ZScsIDAsIFt1ZGlkLCBidW5kbGVJZF0pO1xufVxuXG4vKipcbiAqIEdldCB0aGUgZnVsbCBwYXRoIHRvIHRoZSBwYXJ0aWN1bGFyIGFwcGxpY2F0aW9uIGNvbnRhaW5lclxuICogb24gdGhlIGxvY2FsIGZpbGUgc3lzdGVtLiBOb3RlLCB0aGF0IHRoaXMgc3ViY29tbWFuZCB0aHJvd3NcbiAqIGFuIGVycm9yIGlmIGJ1bmRsZSBpZCBvZiBhIHN5c3RlbSBhcHBsaWNhdGlvbiBpcyBwcm92aWRlZCxcbiAqIGxpa2UgJ2NvbS5hcHBsZS5zcHJpbmdib2FyZCcuXG4gKiBJdCBpcyByZXF1aXJlZCB0aGF0IFNpbXVsYXRvciBpcyBpbiBfYm9vdGVkXyBzdGF0ZS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdWRpZCAtIFRoZSBVRElEIG9mIGFuIGV4aXN0aW5nIFNpbXVsYXRvci5cbiAqIEBwYXJhbSB7c3RyaW5nfSBidW5kbGVJZCAtIEJ1bmRsZSBpZGVudGlmaWVyIG9mIGFuIGFwcGxpY2F0aW9uLlxuICogQHBhcmFtIHs/Ym9vbGVhbn0gbG9nRXJyb3JzIFt0cnVlXSAtIFdoZXRoZXIgdG8gaW5jbHVkZSBleGVjJ3MgY29tbWFuZFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZGVyciBvdXRwdXQgaW50byBleGNlcHRpb24gbWVzc2FnZSBpZiB0aHJvd24uXG4gKiBAcGFyYW0gez9zdHJpbmd9IGNvbnRhaW5lclR5cGUgLSBXaGljaCBjb250YWluZXIgdHlwZSB0byByZXR1cm4uIFBvc3NpYmxlIHZhbHVlc1xuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJlICdhcHAnLCAnZGF0YScsICdncm91cHMnLCAnPEEgc3BlY2lmaWMgQXBwIEdyb3VwIGNvbnRhaW5lcj4nLlxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgJ2FwcCcuXG4gKiBAcmV0dXJuIHtzdHJpbmd9IEZ1bGwgcGF0aCB0byB0aGUgZ2l2ZW4gYXBwbGljYXRpb24gY29udGFpbmVyIG9uIHRoZSBsb2NhbFxuICogICAgICAgICAgICAgICAgICBmaWxlIHN5c3RlbS5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgY29ycmVzcG9uZGluZyBzaW1jdGwgc3ViY29tbWFuZCBjb21tYW5kXG4gKiAgICAgICAgICAgICAgICAgcmV0dXJucyBub24temVybyByZXR1cm4gY29kZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0QXBwQ29udGFpbmVyICh1ZGlkLCBidW5kbGVJZCwgbG9nRXJyb3JzID0gdHJ1ZSwgY29udGFpbmVyVHlwZSA9IG51bGwpIHtcbiAgY29uc3QgYXJncyA9IFt1ZGlkLCBidW5kbGVJZF07XG4gIGlmIChjb250YWluZXJUeXBlKSB7XG4gICAgYXJncy5wdXNoKGNvbnRhaW5lclR5cGUpO1xuICB9XG4gIGNvbnN0IHtzdGRvdXR9ID0gYXdhaXQgc2ltRXhlYygnZ2V0X2FwcF9jb250YWluZXInLCAwLCBhcmdzLCB7fSwgbG9nRXJyb3JzKTtcbiAgcmV0dXJuIChzdGRvdXQgfHwgJycpLnRyaW0oKTtcbn1cblxuLyoqXG4gKiBTaHV0ZG93biB0aGUgZ2l2ZW4gU2ltdWxhdG9yIGlmIGl0IGlzIHJ1bm5pbmcuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVkaWQgLSBUaGUgVURJRCBvZiBhbiBleGlzdGluZyBTaW11bGF0b3IuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIGNvcnJlc3BvbmRpbmcgc2ltY3RsIHN1YmNvbW1hbmQgY29tbWFuZFxuICogICAgICAgICAgICAgICAgIHJldHVybnMgbm9uLXplcm8gcmV0dXJuIGNvZGUuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHNodXRkb3duICh1ZGlkKSB7XG4gIHRyeSB7XG4gICAgYXdhaXQgc2ltRXhlYygnc2h1dGRvd24nLCAwLCBbdWRpZF0pO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBpZiAoIShlcnIgKyAnJykuaW5jbHVkZXMoJ2N1cnJlbnQgc3RhdGU6IFNodXRkb3duJykpIHtcbiAgICAgIHRocm93IGVycjtcbiAgICB9XG4gICAgbG9nLmRlYnVnKGBTaW11bGF0b3IgYWxyZWFkeSBpbiAnU2h1dGRvd24nIHN0YXRlLiBDb250aW51aW5nYCk7XG4gIH1cbn1cblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBTaW1DcmVhdGlvbk9wdHNcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBwbGF0Zm9ybSBbaU9TXSAtIFBsYXRmb3JtIG5hbWUgaW4gb3JkZXIgdG8gc3BlY2lmeSBydW50aW1lIHN1Y2ggYXMgJ2lPUycsICd0dk9TJywgJ3dhdGNoT1MnXG4gKiBAcHJvcGVydHkge251bWJlcn0gdGltZW91dCBbMTAwMDBdIC0gVGhlIG1heGltdW0gbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0XG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5pdCBkZXZpY2UgY3JlYXRpb24gaXMgY29tcGxldGVkLlxuICovXG4vKipcbiAqIENyZWF0ZSBTaW11bGF0b3IgZGV2aWNlIHdpdGggZ2l2ZW4gbmFtZSBmb3IgdGhlIHBhcnRpY3VsYXJcbiAqIHBsYXRmb3JtIHR5cGUgYW5kIHZlcnNpb24uXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgLSBUaGUgZGV2aWNlIG5hbWUgdG8gYmUgY3JlYXRlZC5cbiAqIEBwYXJhbSB7c3RyaW5nfSBkZXZpY2VUeXBlSWQgLSBEZXZpY2UgdHlwZSwgZm9yIGV4YW1wbGUgJ2lQaG9uZSA2Jy5cbiAqIEBwYXJhbSB7c3RyaW5nfSBwbGF0Zm9ybVZlcnNpb24gLSBQbGF0Zm9ybSB2ZXJzaW9uLCBmb3IgZXhhbXBsZSAnMTAuMycuXG4gKiBAcGFyYW0gez9TaW1DcmVhdGlvbk9wdHN9IG9wdHMgLSBTaW11bGF0b3Igb3B0aW9ucyBmb3IgY3JlYXRpbmcgZGV2aWNlcy5cbiAqIEByZXR1cm4ge3N0cmluZ30gVGhlIFVESUQgb2YgdGhlIG5ld2x5IGNyZWF0ZWQgZGV2aWNlLlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBjb3JyZXNwb25kaW5nIHNpbWN0bCBzdWJjb21tYW5kIGNvbW1hbmRcbiAqICAgICAgICAgICAgICAgICByZXR1cm5zIG5vbi16ZXJvIHJldHVybiBjb2RlLlxuICovXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVEZXZpY2UgKG5hbWUsIGRldmljZVR5cGVJZCwgcGxhdGZvcm1WZXJzaW9uLCBvcHRzID0ge30pIHtcbiAgY29uc3Qge1xuICAgIHBsYXRmb3JtID0gU0lNX1JVTlRJTUVfTkFNRV9TVUZGSVhfSU9TLFxuICAgIHRpbWVvdXQgPSBERUZBVUxUX0NSRUFURV9TSU1VTEFUT1JfVElNRU9VVFxuICB9ID0gb3B0cztcblxuICBsZXQgcnVudGltZUlkcyA9IFtdO1xuXG4gIC8vIFRyeSBnZXR0aW5nIHJ1bnRpbWVJZCB1c2luZyBKU09OIGZsYWdcbiAgdHJ5IHtcbiAgICBydW50aW1lSWRzLnB1c2goYXdhaXQgZ2V0UnVudGltZUZvclBsYXRmb3JtVmVyc2lvblZpYUpzb24ocGxhdGZvcm1WZXJzaW9uLCBwbGF0Zm9ybSkpO1xuICB9IGNhdGNoIChpZ24pIHt9XG5cbiAgaWYgKF8uaXNFbXB0eShydW50aW1lSWRzKSkge1xuICAgIC8vIGF0IGZpcnN0IG1ha2Ugc3VyZSB0aGF0IHRoZSBydW50aW1lIGlkIGlzIHRoZSByaWdodCBvbmVcbiAgICAvLyBpbiBzb21lIHZlcnNpb25zIG9mIFhjb2RlIGl0IHdpbGwgYmUgYSBwYXRjaCB2ZXJzaW9uXG4gICAgbGV0IHJ1bnRpbWVJZDtcbiAgICB0cnkge1xuICAgICAgcnVudGltZUlkID0gYXdhaXQgZ2V0UnVudGltZUZvclBsYXRmb3JtVmVyc2lvbihwbGF0Zm9ybVZlcnNpb24sIHBsYXRmb3JtKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGxvZy53YXJuKGBVbmFibGUgdG8gZmluZCBydW50aW1lIGZvciBpT1MgJyR7cGxhdGZvcm1WZXJzaW9ufScuIENvbnRpbnVpbmdgKTtcbiAgICAgIHJ1bnRpbWVJZCA9IHBsYXRmb3JtVmVyc2lvbjtcbiAgICB9XG5cbiAgICAvLyBnZXQgdGhlIHBvc3NpYmxlIHJ1bnRpbWVzLCB3aGljaCB3aWxsIGJlIGl0ZXJhdGVkIG92ZXJcblxuICAgIC8vIHN0YXJ0IHdpdGggbWFqb3ItbWlub3IgdmVyc2lvblxuICAgIGxldCBwb3RlbnRpYWxSdW50aW1lSWRzID0gW25vcm1hbGl6ZVZlcnNpb24ocnVudGltZUlkKV07XG4gICAgaWYgKHJ1bnRpbWVJZC5zcGxpdCgnLicpLmxlbmd0aCA9PT0gMykge1xuICAgICAgLy8gYWRkIHBhdGNoIHZlcnNpb24gaWYgaXQgZXhpc3RzXG4gICAgICBwb3RlbnRpYWxSdW50aW1lSWRzLnB1c2gocnVudGltZUlkKTtcbiAgICB9XG5cbiAgICAvLyBhZGQgbW9kaWZpZWQgdmVyc2lvbnMsIHNpbmNlIG1vZGVybiBYY29kZXMgdXNlIHRoaXMsIHRoZW4gdGhlIGJhcmVcbiAgICAvLyB2ZXJzaW9ucywgdG8gYWNjb21vZGF0ZSBvbGRlciBYY29kZXNcbiAgICBydW50aW1lSWRzLnB1c2goXG4gICAgICAuLi4ocG90ZW50aWFsUnVudGltZUlkcy5tYXAoKGlkKSA9PiBgJHtTSU1fUlVOVElNRV9OQU1FfSR7cGxhdGZvcm19LSR7aWQucmVwbGFjZSgvXFwuL2csICctJyl9YCkpLFxuICAgICAgLi4ucG90ZW50aWFsUnVudGltZUlkc1xuICAgICk7XG4gIH1cblxuICAvLyBnbyB0aHJvdWdoIHRoZSBydW50aW1lIGlkcyBhbmQgdHJ5IHRvIGNyZWF0ZSBhIHNpbXVsYXRvciB3aXRoIGVhY2hcbiAgbGV0IHVkaWQ7XG4gIGZvciAoY29uc3QgcnVudGltZUlkIG9mIHJ1bnRpbWVJZHMpIHtcbiAgICBsb2cuZGVidWcoYENyZWF0aW5nIHNpbXVsYXRvciB3aXRoIG5hbWUgJyR7bmFtZX0nLCBkZXZpY2UgdHlwZSBpZCAnJHtkZXZpY2VUeXBlSWR9JyBhbmQgcnVudGltZSBpZCAnJHtydW50aW1lSWR9J2ApO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBvdXQgPSBhd2FpdCBzaW1FeGVjKCdjcmVhdGUnLCAwLCBbbmFtZSwgZGV2aWNlVHlwZUlkLCBydW50aW1lSWRdKTtcbiAgICAgIHVkaWQgPSBvdXQuc3Rkb3V0LnRyaW0oKTtcbiAgICAgIGJyZWFrO1xuICAgIH0gY2F0Y2ggKGlnbikge1xuICAgICAgLy8gdGhlIGVycm9yIGdldHMgbG9nZ2VkIGluIGBzaW1FeGVjYFxuICAgIH1cbiAgfVxuXG4gIGlmICghdWRpZCkge1xuICAgIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IGNyZWF0ZSBzaW11bGF0b3Igd2l0aCBuYW1lICcke25hbWV9JywgZGV2aWNlIGAgK1xuICAgICAgYHR5cGUgaWQgJyR7ZGV2aWNlVHlwZUlkfScsIHdpdGggcnVudGltZSBpZHMgYCArXG4gICAgICBgJHtydW50aW1lSWRzLm1hcCgoaWQpID0+IGAnJHtpZH0nYCkuam9pbignLCAnKX1gKTtcbiAgfVxuXG4gIC8vIG1ha2Ugc3VyZSB0aGF0IGl0IGdldHMgb3V0IG9mIHRoZSBcIkNyZWF0aW5nXCIgc3RhdGVcbiAgY29uc3QgcmV0cmllcyA9IHBhcnNlSW50KHRpbWVvdXQgLyAxMDAwLCAxMCk7XG4gIGF3YWl0IHJldHJ5SW50ZXJ2YWwocmV0cmllcywgMTAwMCwgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGRldmljZXMgPSBfLnZhbHVlcyhhd2FpdCBnZXREZXZpY2VzKCkpO1xuICAgIGZvciAoY29uc3QgZGV2aWNlQXJyIG9mIF8udmFsdWVzKGRldmljZXMpKSB7XG4gICAgICBmb3IgKGNvbnN0IGRldmljZSBvZiBkZXZpY2VBcnIpIHtcbiAgICAgICAgaWYgKGRldmljZS51ZGlkID09PSB1ZGlkKSB7XG4gICAgICAgICAgaWYgKGRldmljZS5zdGF0ZSA9PT0gJ0NyZWF0aW5nJykge1xuICAgICAgICAgICAgLy8gbmVlZCB0byByZXRyeVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBEZXZpY2Ugd2l0aCB1ZGlkICcke3VkaWR9JyBzdGlsbCBiZWluZyBjcmVhdGVkYCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIHN0b3AgbG9va2luZywgd2UncmUgZG9uZVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoYERldmljZSB3aXRoIHVkaWQgJyR7dWRpZH0nIG5vdCB5ZXQgY3JlYXRlZGApO1xuICB9KTtcblxuICByZXR1cm4gdWRpZDtcbn1cblxuLyoqXG4gKiBEZWxldGUgdGhlIHBhcnRpY3VsYXIgU2ltdWxhdG9yIGZyb20gYXZhaWxhYmxlIGRldmljZXMgbGlzdC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdWRpZCAtIFRoZSBVRElEIG9mIGFuIGV4aXN0aW5nIFNpbXVsYXRvci5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgY29ycmVzcG9uZGluZyBzaW1jdGwgc3ViY29tbWFuZCBjb21tYW5kXG4gKiAgICAgICAgICAgICAgICAgcmV0dXJucyBub24temVybyByZXR1cm4gY29kZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZGVsZXRlRGV2aWNlICh1ZGlkKSB7XG4gIGF3YWl0IHNpbUV4ZWMoJ2RlbGV0ZScsIDAsIFt1ZGlkXSk7XG59XG5cbi8qKlxuICogUmVzZXQgdGhlIGNvbnRlbnQgYW5kIHNldHRpbmdzIG9mIHRoZSBwYXJ0aWN1bGFyIFNpbXVsYXRvci5cbiAqIEl0IGlzIHJlcXVpcmVkIHRoYXQgU2ltdWxhdG9yIGlzIGluIF9zaHV0ZG93bl8gc3RhdGUuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVkaWQgLSBUaGUgVURJRCBvZiBhbiBleGlzdGluZyBTaW11bGF0b3IuXG4gKiBAcGFyYW0ge251bWJlcn0gdGltZW91dCBbMTAwMDBdIC0gVGhlIG1heGltdW0gbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0XG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5pdCBkZXZpY2UgcmVzZXQgaXMgY29tcGxldGVkLlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBjb3JyZXNwb25kaW5nIHNpbWN0bCBzdWJjb21tYW5kIGNvbW1hbmRcbiAqICAgICAgICAgICAgICAgICByZXR1cm5zIG5vbi16ZXJvIHJldHVybiBjb2RlLlxuICovXG5hc3luYyBmdW5jdGlvbiBlcmFzZURldmljZSAodWRpZCwgdGltZW91dCA9IDEwMDApIHtcbiAgbGV0IGxvb3BGbiA9IGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBzaW1FeGVjKCdlcmFzZScsIDEwMDAwLCBbdWRpZF0pO1xuICB9O1xuICAvLyByZXRyeSBlcmFzZSB3aXRoIGEgc2xlZXAgaW4gYmV0d2VlbiBiZWNhdXNlIGl0J3MgZmxha2V5XG4gIGxldCByZXRyaWVzID0gcGFyc2VJbnQodGltZW91dCAvIDIwMCwgMTApO1xuICBhd2FpdCByZXRyeUludGVydmFsKHJldHJpZXMsIDIwMCwgbG9vcEZuKTtcbn1cblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBEZXZpY2VJbmZvXG4gKiBAcHJvcGVydHkge3N0cmluZ30gbmFtZSAtIFRoZSBkZXZpY2UgbmFtZS5cbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSB1ZGlkIC0gVGhlIGRldmljZSBVRElELlxuICogQHByb3BlcnR5IHtzdHJpbmd9IHN0YXRlIC0gVGhlIGN1cnJlbnQgU2ltdWxhdG9yIHN0YXRlLCBmb3IgZXhhbXBsZSAnYm9vdGVkJyBvciAnc2h1dGRvd24nLlxuICogQHByb3BlcnR5IHtzdHJpbmd9IHNkayAtIFRoZSBTREsgdmVyc2lvbiwgZm9yIGV4YW1wbGUgJzEwLjMnLlxuICovXG5cbi8qKlxuICogUGFyc2UgdGhlIGxpc3Qgb2YgZXhpc3RpbmcgU2ltdWxhdG9yIGRldmljZXMgdG8gcmVwcmVzZW50XG4gKiBpdCBhcyBjb252ZW5pZW50IG1hcHBpbmcuXG4gKlxuICogQHBhcmFtIHs/c3RyaW5nfSBwbGF0Zm9ybSAtIFRoZSBwbGF0Zm9ybSBuYW1lLCBmb3IgZXhhbXBsZSAnd2F0Y2hPUycuXG4gKiBAcmV0dXJuIHtPYmplY3R9IFRoZSByZXN1bHRpbmcgbWFwcGluZy4gRWFjaCBrZXkgaXMgcGxhdGZvcm0gdmVyc2lvbixcbiAqICAgICAgICAgICAgICAgICAgZm9yIGV4YW1wbGUgJzEwLjMnIGFuZCB0aGUgY29ycmVzcG9uZGluZyB2YWx1ZSBpcyBhblxuICogICAgICAgICAgICAgICAgICBhcnJheSBvZiB0aGUgbWF0Y2hpbmcge0BsaW5rIERldmljZUluZm99IGluc3RhbmNlcy5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgY29ycmVzcG9uZGluZyBzaW1jdGwgc3ViY29tbWFuZCBjb21tYW5kXG4gKiAgICAgICAgICAgICAgICAgcmV0dXJucyBub24temVybyByZXR1cm4gY29kZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0RGV2aWNlc0J5UGFyc2luZyAocGxhdGZvcm0pIHtcbiAgLy8gZ2V0IHRoZSBsaXN0IG9mIGRldmljZXNcbiAgY29uc3Qge3N0ZG91dH0gPSBhd2FpdCBzaW1FeGVjKCdsaXN0JywgMCwgWydkZXZpY2VzJ10pO1xuXG4gIC8vIGV4cGVjdCB0byBnZXQgYSBsaXN0aW5nIGxpa2VcbiAgLy8gLS0gaU9TIDguMSAtLVxuICAvLyAgICAgaVBob25lIDRzICgzQ0E2RTdERC0yMjBFLTQ1RTUtQjcxNi0xRTk5MkIzQTQyOUMpIChTaHV0ZG93bilcbiAgLy8gICAgIC4uLlxuICAvLyAtLSBpT1MgOC4yIC0tXG4gIC8vICAgICBpUGhvbmUgNHMgKEE5OUZGRkMzLThFMTktNERDRi1CNTg1LTdEOUQ0NkI0QzE2RSkgKFNodXRkb3duKVxuICAvLyAgICAgLi4uXG4gIC8vIHNvLCBnZXQgdGhlIGAtLSBpT1MgWC5YIC0tYCBsaW5lIHRvIGZpbmQgdGhlIHNkayAoWC5YKVxuICAvLyBhbmQgdGhlIHJlc3Qgb2YgdGhlIGxpc3RpbmcgaW4gb3JkZXIgdG8gbGF0ZXIgZmluZCB0aGUgZGV2aWNlc1xuICBjb25zdCBkZXZpY2VTZWN0aW9uUmUgPSBfLmlzRW1wdHkocGxhdGZvcm0pXG4gICAgPyBuZXcgUmVnRXhwKGBcXFxcLVxcXFwtXFxcXHMrKFxcXFxTKylcXFxccysoXFxcXFMrKVxcXFxzK1xcXFwtXFxcXC0oXFxcXG5cXFxcc3s0fS4rKSpgLCAnbWdpJylcbiAgICA6IG5ldyBSZWdFeHAoYFxcXFwtXFxcXC1cXFxccyske18uZXNjYXBlUmVnRXhwKHBsYXRmb3JtKX1cXFxccysoXFxcXFMrKVxcXFxzK1xcXFwtXFxcXC0oXFxcXG5cXFxcc3s0fS4rKSpgLCAnbWdpJyk7XG4gIGNvbnN0IG1hdGNoZXMgPSBbXTtcbiAgbGV0IG1hdGNoO1xuICAvLyBtYWtlIGFuIGVudHJ5IGZvciBlYWNoIHNkayB2ZXJzaW9uXG4gIHdoaWxlICgobWF0Y2ggPSBkZXZpY2VTZWN0aW9uUmUuZXhlYyhzdGRvdXQpKSkge1xuICAgIG1hdGNoZXMucHVzaChtYXRjaCk7XG4gIH1cbiAgaWYgKF8uaXNFbXB0eShtYXRjaGVzKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGZpbmQgZGV2aWNlIHNlY3Rpb24nKTtcbiAgfVxuXG4gIGNvbnN0IGxpbmVSZSA9IC8oW15cXHNdLispIFxcKChcXHcrLS4rXFx3KylcXCkgXFwoKFxcdytcXHM/XFx3KylcXCkvOyAvLyBodHRwczovL3JlZ2V4MTAxLmNvbS9yL2xHN21LNi8zXG4gIC8vIGdldCBhbGwgdGhlIGRldmljZXMgZm9yIGVhY2ggc2RrXG4gIGNvbnN0IGRldmljZXMgPSB7fTtcbiAgZm9yIChtYXRjaCBvZiBtYXRjaGVzKSB7XG4gICAgY29uc3Qgc2RrID0gcGxhdGZvcm0gPyBtYXRjaFsxXSA6IG1hdGNoWzJdO1xuICAgIGRldmljZXNbc2RrXSA9IGRldmljZXNbc2RrXSB8fCBbXTtcbiAgICAvLyBzcGxpdCB0aGUgZnVsbCBtYXRjaCBpbnRvIGxpbmVzIGFuZCByZW1vdmUgdGhlIGZpcnN0XG4gICAgZm9yIChjb25zdCBsaW5lIG9mIG1hdGNoWzBdLnNwbGl0KCdcXG4nKS5zbGljZSgxKSkge1xuICAgICAgaWYgKGxpbmUuaW5jbHVkZXMoJyh1bmF2YWlsYWJsZSwgJykpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICAvLyBhIGxpbmUgaXMgc29tZXRoaW5nIGxpa2VcbiAgICAgIC8vICAgIGlQaG9uZSA0cyAoQTk5RkZGQzMtOEUxOS00RENGLUI1ODUtN0Q5RDQ2QjRDMTZFKSAoU2h1dGRvd24pXG4gICAgICAvLyByZXRyaWV2ZTpcbiAgICAgIC8vICAgaVBob25lIDRzXG4gICAgICAvLyAgIEE5OUZGRkMzLThFMTktNERDRi1CNTg1LTdEOUQ0NkI0QzE2RVxuICAgICAgLy8gICBTaHV0ZG93blxuICAgICAgY29uc3QgbGluZU1hdGNoID0gbGluZVJlLmV4ZWMobGluZSk7XG4gICAgICBpZiAoIWxpbmVNYXRjaCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENvdWxkIG5vdCBtYXRjaCBsaW5lOiAke2xpbmV9YCk7XG4gICAgICB9XG4gICAgICAvLyBzYXZlIHRoZSB3aG9sZSB0aGluZyBhcyBhYiBvYmplY3QgaW4gdGhlIGxpc3QgZm9yIHRoaXMgc2RrXG4gICAgICBkZXZpY2VzW3Nka10ucHVzaCh7XG4gICAgICAgIG5hbWU6IGxpbmVNYXRjaFsxXSxcbiAgICAgICAgdWRpZDogbGluZU1hdGNoWzJdLFxuICAgICAgICBzdGF0ZTogbGluZU1hdGNoWzNdLFxuICAgICAgICBzZGssXG4gICAgICAgIHBsYXRmb3JtOiBwbGF0Zm9ybSB8fCBtYXRjaFsxXSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZGV2aWNlcztcbn1cblxuLyoqXG4gKiBQYXJzZSB0aGUgbGlzdCBvZiBleGlzdGluZyBTaW11bGF0b3IgZGV2aWNlcyB0byByZXByZXNlbnRcbiAqIGl0IGFzIGNvbnZlbmllbnQgbWFwcGluZyBmb3IgdGhlIHBhcnRpY3VsYXIgcGxhdGZvcm0gdmVyc2lvbi5cbiAqXG4gKiBAcGFyYW0gez9zdHJpbmd9IGZvclNkayAtIFRoZSBzZGsgdmVyc2lvbixcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIHdoaWNoIHRoZSBkZXZpY2VzIGxpc3Qgc2hvdWxkIGJlIHBhcnNlZCxcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGV4YW1wbGUgJzEwLjMnLlxuICogQHBhcmFtIHs/c3RyaW5nfSBwbGF0Zm9ybSAtIFRoZSBwbGF0Zm9ybSBuYW1lLCBmb3IgZXhhbXBsZSAnd2F0Y2hPUycuXG4gKiBAcmV0dXJuIHtPYmplY3R8QXJyYXk8RGV2aWNlSW5mbz59IElmIF9mb3JTZGtfIGlzIHNldCB0aGVuIHRoZSBsaXN0XG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mIGRldmljZXMgZm9yIHRoZSBwYXJ0aWN1bGFyIHBsYXRmb3JtIHZlcnNpb24uXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE90aGVyd2lzZSB0aGUgc2FtZSByZXN1bHQgYXMgZm9yIHtAbGluayBnZXREZXZpY2VzQnlQYXJzaW5nfVxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbi5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgY29ycmVzcG9uZGluZyBzaW1jdGwgc3ViY29tbWFuZCBjb21tYW5kXG4gKiAgICAgICAgICAgICAgICAgcmV0dXJucyBub24temVybyByZXR1cm4gY29kZSBvciBpZiBubyBtYXRjaGluZ1xuICogICAgICAgICAgICAgICAgIHBsYXRmb3JtIHZlcnNpb24gaXMgZm91bmQgaW4gdGhlIHN5c3RlbS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0RGV2aWNlcyAoZm9yU2RrLCBwbGF0Zm9ybSkge1xuICBsZXQgZGV2aWNlcyA9IHt9O1xuICB0cnkge1xuICAgIGNvbnN0IHtzdGRvdXR9ID0gYXdhaXQgc2ltRXhlYygnbGlzdCcsIDAsIFsnZGV2aWNlcycsICctaiddKTtcbiAgICAvKiBKU09OIHNob3VsZCBiZVxuICAgICAqIHtcbiAgICAgKiAgIFwiZGV2aWNlc1wiIDoge1xuICAgICAqICAgICBcImlPUyA8c2RrPlwiIDogWyAvLyBvclxuICAgICAqICAgICBcImNvbS5hcHBsZS5Db3JlU2ltdWxhdG9yLlNpbVJ1bnRpbWUuaU9TLTxzZGs+IDogW1xuICAgICAqICAgICAgIHtcbiAgICAgKiAgICAgICAgIFwic3RhdGVcIiA6IFwiQm9vdGVkXCIsXG4gICAgICogICAgICAgICBcImF2YWlsYWJpbGl0eVwiIDogXCIoYXZhaWxhYmxlKVwiLFxuICAgICAqICAgICAgICAgXCJpc0F2YWlsYWJsZVwiIDogdHJ1ZSxcbiAgICAgKiAgICAgICAgIFwibmFtZVwiIDogXCJpUGhvbmUgNlwiLFxuICAgICAqICAgICAgICAgXCJ1ZGlkXCIgOiBcIjc1RTM0MTQwLTE4RTgtNEQxQS05RjQ1LUFBQzczNURGNzVERlwiXG4gICAgICogICAgICAgfVxuICAgICAqICAgICBdXG4gICAgICogICB9XG4gICAgICogfVxuICAgICAqL1xuICAgIGNvbnN0IHZlcnNpb25NYXRjaFJlID0gXy5pc0VtcHR5KHBsYXRmb3JtKVxuICAgICAgPyBuZXcgUmVnRXhwKGBeKFteXFxcXHMtXSspW1xcXFxzLV0oXFxcXFMrKWAsICdpJylcbiAgICAgIDogbmV3IFJlZ0V4cChgXiR7Xy5lc2NhcGVSZWdFeHAocGxhdGZvcm0pfVtcXFxccy1dKFxcXFxTKylgLCAnaScpO1xuICAgIGZvciAobGV0IFtzZGtOYW1lLCBlbnRyaWVzXSBvZiBfLnRvUGFpcnMoSlNPTi5wYXJzZShzdGRvdXQpLmRldmljZXMpKSB7XG4gICAgICAvLyB0aGVyZSBjb3VsZCBiZSBhIGxvbmdlciBuYW1lLCBzbyByZW1vdmUgaXRcbiAgICAgIHNka05hbWUgPSBzZGtOYW1lLnJlcGxhY2UoU0lNX1JVTlRJTUVfTkFNRSwgJycpO1xuICAgICAgY29uc3QgdmVyc2lvbk1hdGNoID0gdmVyc2lvbk1hdGNoUmUuZXhlYyhzZGtOYW1lKTtcbiAgICAgIGlmICghdmVyc2lvbk1hdGNoKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICAvLyB0aGUgc2RrIGNhbiBoYXZlIGRhc2hlcyAoYDEyLTJgKSBvciBkb3RzIChgMTIuMWApXG4gICAgICBjb25zdCBzZGsgPSAocGxhdGZvcm0gPyB2ZXJzaW9uTWF0Y2hbMV0gOiB2ZXJzaW9uTWF0Y2hbMl0pLnJlcGxhY2UoJy0nLCAnLicpO1xuICAgICAgZGV2aWNlc1tzZGtdID0gZGV2aWNlc1tzZGtdIHx8IFtdO1xuICAgICAgZGV2aWNlc1tzZGtdLnB1c2goLi4uZW50cmllcy5maWx0ZXIoKGVsKSA9PiBfLmlzVW5kZWZpbmVkKGVsLmlzQXZhaWxhYmxlKSB8fCBlbC5pc0F2YWlsYWJsZSlcbiAgICAgICAgLm1hcCgoZWwpID0+IHtcbiAgICAgICAgICBkZWxldGUgZWwuYXZhaWxhYmlsaXR5O1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzZGssXG4gICAgICAgICAgICAuLi5lbCxcbiAgICAgICAgICAgIHBsYXRmb3JtOiBwbGF0Zm9ybSB8fCB2ZXJzaW9uTWF0Y2hbMV0sXG4gICAgICAgICAgfTtcbiAgICAgICAgfSlcbiAgICAgICk7XG4gICAgfVxuICB9IGNhdGNoIChlcnIpIHtcbiAgICBsb2cuZGVidWcoYFVuYWJsZSB0byBnZXQgSlNPTiBkZXZpY2UgbGlzdDogJHtlcnIuc3RhY2t9YCk7XG4gICAgbG9nLmRlYnVnKCdGYWxsaW5nIGJhY2sgdG8gbWFudWFsIHBhcnNpbmcnKTtcbiAgICBkZXZpY2VzID0gYXdhaXQgZ2V0RGV2aWNlc0J5UGFyc2luZyhwbGF0Zm9ybSk7XG4gIH1cblxuICBpZiAoIWZvclNkaykge1xuICAgIHJldHVybiBkZXZpY2VzO1xuICB9XG4gIC8vIGlmIGEgYGZvclNka2Agd2FzIHBhc3NlZCBpbiwgcmV0dXJuIG9ubHkgdGhlIGNvcnJlc3BvbmRpbmcgbGlzdFxuICBpZiAoZGV2aWNlc1tmb3JTZGtdKSB7XG4gICAgcmV0dXJuIGRldmljZXNbZm9yU2RrXTtcbiAgfVxuXG4gIGxldCBlcnJNc2cgPSBgJyR7Zm9yU2RrfScgZG9lcyBub3QgZXhpc3QgaW4gdGhlIGxpc3Qgb2Ygc2ltY3RsIFNES3MuYDtcbiAgY29uc3QgYXZhaWxhYmxlU0RLcyA9IF8ua2V5cyhkZXZpY2VzKTtcbiAgZXJyTXNnICs9IGF2YWlsYWJsZVNES3MubGVuZ3RoXG4gICAgPyBgIE9ubHkgdGhlIGZvbGxvd2luZyBTaW11bGF0b3IgU0RLIHZlcnNpb25zIGFyZSBhdmFpbGFibGUgb24geW91ciBzeXN0ZW06ICR7YXZhaWxhYmxlU0RLcy5qb2luKCcsICcpfWBcbiAgICA6IGAgTm8gU2ltdWxhdG9yIFNESyB2ZXJzaW9ucyBhcmUgYXZhaWxhYmxlIG9uIHlvdXIgc3lzdGVtLiBQbGVhc2UgaW5zdGFsbCBzb21lIHZpYSBYY29kZSBwcmVmZXJlbmNlcy5gO1xuICB0aHJvdyBuZXcgRXJyb3IoZXJyTXNnKTtcbn1cblxuXG4vKipcbiAqIFwiTm9ybWFsaXplXCIgdGhlIHZlcnNpb24sIHNpbmNlIGlPUyB1c2VzICdtYWpvci5taW5vcicgYnV0IHRoZSBydW50aW1lcyBjYW5cbiAqIGJlICdtYWpvci5taW5vci5wYXRjaCdcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdmVyc2lvbiAtIHRoZSBzdHJpbmcgdmVyc2lvblxuICogQHJldHVybiB7c3RyaW5nfSBUaGUgdmVyc2lvbiBpbiAnbWFqb3IubWlub3InIGZvcm1cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgdmVyc2lvbiBub3QgcGFyc2VhYmxlIGJ5IHRoZSBgc2VtdmVyYCBwYWNrYWdlXG4gKi9cbmZ1bmN0aW9uIG5vcm1hbGl6ZVZlcnNpb24gKHZlcnNpb24pIHtcbiAgY29uc3Qgc2VtdmVyVmVyc2lvbiA9IHNlbXZlci5jb2VyY2UodmVyc2lvbik7XG4gIGlmIChfLmlzTmlsKHNlbXZlclZlcnNpb24pKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBVbmFibGUgdG8gcGFyc2UgdmVyc2lvbiAnJHt2ZXJzaW9ufSdgKTtcbiAgfVxuICByZXR1cm4gYCR7c2VtdmVyVmVyc2lvbi5tYWpvcn0uJHtzZW12ZXJWZXJzaW9uLm1pbm9yfWA7XG59XG5cbi8qKlxuICogR2V0IHRoZSBydW50aW1lIGZvciB0aGUgcGFydGljdWxhciBwbGF0Zm9ybSB2ZXJzaW9uIHVzaW5nIC0tanNvbiBmbGFnXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHBsYXRmb3JtVmVyc2lvbiAtIFRoZSBwbGF0Zm9ybSB2ZXJzaW9uIG5hbWUsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGV4YW1wbGUgJzEwLjMnLlxuICogQHBhcmFtIHs/c3RyaW5nfSBwbGF0Zm9ybSAtIFRoZSBwbGF0Zm9ybSBuYW1lLCBmb3IgZXhhbXBsZSAnd2F0Y2hPUycuXG4gKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBjb3JyZXNwb25kaW5nIHJ1bnRpbWUgbmFtZSBmb3IgdGhlIGdpdmVuXG4gKiAgICAgICAgICAgICAgICAgIHBsYXRmb3JtIHZlcnNpb24uXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGdldFJ1bnRpbWVGb3JQbGF0Zm9ybVZlcnNpb25WaWFKc29uIChwbGF0Zm9ybVZlcnNpb24sIHBsYXRmb3JtID0gJ2lPUycpIHtcbiAgY29uc3Qge3N0ZG91dH0gPSBhd2FpdCBzaW1FeGVjKCdsaXN0JywgMCwgWydydW50aW1lcycsICctLWpzb24nXSk7XG4gIGZvciAoY29uc3Qge3ZlcnNpb24sIGlkZW50aWZpZXIsIG5hbWV9IG9mIEpTT04ucGFyc2Uoc3Rkb3V0KS5ydW50aW1lcykge1xuICAgIGlmIChub3JtYWxpemVWZXJzaW9uKHZlcnNpb24pID09PSBub3JtYWxpemVWZXJzaW9uKHBsYXRmb3JtVmVyc2lvbilcbiAgICAgICYmIG5hbWUudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKHBsYXRmb3JtLnRvTG93ZXJDYXNlKCkpKSB7XG4gICAgICByZXR1cm4gaWRlbnRpZmllcjtcbiAgICB9XG4gIH1cbiAgdGhyb3cgbmV3IEVycm9yKGBDb3VsZCBub3QgdXNlIC0tanNvbiBmbGFnIHRvIHBhcnNlIHBsYXRmb3JtIHZlcnNpb25gKTtcbn1cblxuLyoqXG4gKiBHZXQgdGhlIHJ1bnRpbWUgZm9yIHRoZSBwYXJ0aWN1bGFyIHBsYXRmb3JtIHZlcnNpb24uXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHBsYXRmb3JtVmVyc2lvbiAtIFRoZSBwbGF0Zm9ybSB2ZXJzaW9uIG5hbWUsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGV4YW1wbGUgJzEwLjMnLlxuICogQHBhcmFtIHs/c3RyaW5nfSBwbGF0Zm9ybSAtIFRoZSBwbGF0Zm9ybSBuYW1lLCBmb3IgZXhhbXBsZSAnd2F0Y2hPUycuXG4gKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBjb3JyZXNwb25kaW5nIHJ1bnRpbWUgbmFtZSBmb3IgdGhlIGdpdmVuXG4gKiAgICAgICAgICAgICAgICAgIHBsYXRmb3JtIHZlcnNpb24uXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGdldFJ1bnRpbWVGb3JQbGF0Zm9ybVZlcnNpb24gKHBsYXRmb3JtVmVyc2lvbiwgcGxhdGZvcm0gPSAnaU9TJykge1xuICAvLyBUcnkgd2l0aCBwYXJzaW5nXG4gIHRyeSB7XG4gICAgY29uc3Qge3N0ZG91dH0gPSBhd2FpdCBzaW1FeGVjKCdsaXN0JywgMCwgWydydW50aW1lcyddKTtcbiAgICAvLyBodHRwczovL3JlZ2V4MTAxLmNvbS9yL1V5a2pRWi8xXG4gICAgY29uc3QgcnVudGltZVJlID0gbmV3IFJlZ0V4cChgJHtfLmVzY2FwZVJlZ0V4cChwbGF0Zm9ybSl9XFxcXHMrKFxcXFxkK1xcXFwuXFxcXGQrKVxcXFxzK1xcXFwoKFxcXFxkK1xcXFwuXFxcXGQrXFxcXC4qXFxcXGQqKWAsICdpJyk7XG4gICAgZm9yIChjb25zdCBsaW5lIG9mIHN0ZG91dC5zcGxpdCgnXFxuJykpIHtcbiAgICAgIGNvbnN0IG1hdGNoID0gcnVudGltZVJlLmV4ZWMobGluZSk7XG4gICAgICBpZiAobWF0Y2ggJiYgbWF0Y2hbMV0gPT09IHBsYXRmb3JtVmVyc2lvbikge1xuICAgICAgICByZXR1cm4gbWF0Y2hbMl07XG4gICAgICB9XG4gICAgfVxuICB9IGNhdGNoIChpZ24pIHt9XG5cbiAgLy8gaWYgbm90aGluZyB3YXMgZm91bmQsIHBhc3MgcGxhdGZvcm0gdmVyc2lvbiBiYWNrXG4gIHJldHVybiBwbGF0Zm9ybVZlcnNpb247XG59XG5cbi8qKlxuICogR2V0cyBiYXNlNjQgc2NyZWVuc2hvdCBmb3IgZGV2aWNlICh4Y29kZSA+PSA4LjEgb25seSkuXG4gKiBJdCBpcyByZXF1aXJlZCB0aGF0IFNpbXVsYXRvciBpcyBpbiBfYm9vdGVkXyBzdGF0ZS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdWRpZCAtIFRoZSBVRElEIG9mIGFuIGV4aXN0aW5nIFNpbXVsYXRvci5cbiAqIEByZXR1cm4ge3N0cmluZ30gQmFzZTY0LWVuY29kZWQgU2ltdWxhdG9yIHNjcmVlbnNob3QuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIGNvcnJlc3BvbmRpbmcgc2ltY3RsIHN1YmNvbW1hbmQgY29tbWFuZFxuICogICAgICAgICAgICAgICAgIHJldHVybnMgbm9uLXplcm8gcmV0dXJuIGNvZGUuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGdldFNjcmVlbnNob3QgKHVkaWQpIHtcbiAgbGV0IHBhdGhUb1NjcmVlbnNob3RQbmcgPSBhd2FpdCB0ZW1wRGlyLnBhdGgoe3ByZWZpeDogYHNjcmVlbnNob3QtJHt1ZGlkfWAsIHN1ZmZpeDogJy5wbmcnfSk7XG4gIGF3YWl0IHNpbUV4ZWMoJ2lvJywgMCwgW3VkaWQsICdzY3JlZW5zaG90JywgcGF0aFRvU2NyZWVuc2hvdFBuZ10pO1xuICBsZXQgc2NyZWVuc2hvdEltZyA9IGF3YWl0IGZzLnJlYWRGaWxlKHBhdGhUb1NjcmVlbnNob3RQbmcpO1xuICBhd2FpdCBmcy5yaW1yYWYocGF0aFRvU2NyZWVuc2hvdFBuZyk7XG4gIHJldHVybiBzY3JlZW5zaG90SW1nLnRvU3RyaW5nKCdiYXNlNjQnKTtcbn1cblxuLyoqXG4gKiBTZXQgdGhlIGNvbnRlbnQgb2YgU2ltdWxhdG9yIHBhc3RlYm9hcmQgKHhjb2RlID49IDguMSBvbmx5KS5cbiAqIEl0IGlzIHJlcXVpcmVkIHRoYXQgU2ltdWxhdG9yIGlzIGluIF9ib290ZWRfIHN0YXRlLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSB1ZGlkIC0gRGV2aWNlIFVESUQuXG4gKiBAcGFyYW0ge3N0cmluZ30gY29udGVudCAtIFRoZSBhY3R1YWwgc3RyaW5nIGNvbnRlbnQgdG8gYmUgc2V0LlxuICogQHBhcmFtIHtzdHJpbmd9IGVuY29kaW5nIFsndXRmLTgnXSAtIFRoZSBlbmNvZGluZyBvZiB0aGUgZ2l2ZW4gcGFzdGVib2FyZCBjb250ZW50LlxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFVURi04IGJ5IGRlZmF1bHQuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIGNvcnJlc3BvbmRpbmcgc2ltY3RsIHN1YmNvbW1hbmQgY29tbWFuZFxuICogICAgICAgICAgICAgICAgIHJldHVybnMgbm9uLXplcm8gcmV0dXJuIGNvZGUuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHNldFBhc3RlYm9hcmQgKHVkaWQsIGNvbnRlbnQsIGVuY29kaW5nID0gJ3V0Zi04Jykge1xuICBjb25zdCBwYkNvcHlTdWJwcm9jZXNzID0gbmV3IFN1YlByb2Nlc3MoJ3hjcnVuJywgWydzaW1jdGwnLCAncGJjb3B5JywgdWRpZF0pO1xuICBhd2FpdCBwYkNvcHlTdWJwcm9jZXNzLnN0YXJ0KDApO1xuICBjb25zdCBleGl0Q29kZVZlcmlmaWVyID0gcGJDb3B5U3VicHJvY2Vzcy5qb2luKCk7XG4gIGNvbnN0IHN0ZGluID0gcGJDb3B5U3VicHJvY2Vzcy5wcm9jLnN0ZGluO1xuICBzdGRpbi5zZXRFbmNvZGluZyhlbmNvZGluZyk7XG4gIHN0ZGluLndyaXRlKGNvbnRlbnQpO1xuICBzdGRpbi5lbmQoKTtcbiAgYXdhaXQgZXhpdENvZGVWZXJpZmllcjtcbn1cblxuLyoqXG4gKiBHZXQgdGhlIGNvbnRlbnQgb2YgU2ltdWxhdG9yIHBhc3RlYm9hcmQgKHhjb2RlID49IDguMSBvbmx5KS5cbiAqIEl0IGlzIHJlcXVpcmVkIHRoYXQgU2ltdWxhdG9yIGlzIGluIF9ib290ZWRfIHN0YXRlLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSB1ZGlkIC0gRGV2aWNlIFVESUQuXG4gKiBAcGFyYW0ge3N0cmluZ30gZW5jb2RpbmcgWyd1dGYtOCddIC0gVGhlIGVuY29kaW5nIG9mIHRoZSByZXR1cm5lZCBwYXN0ZWJvYXJkIGNvbnRlbnQuXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVVRGLTggYnkgZGVmYXVsdC5cbiAqIEByZXR1cm4ge3N0cmluZ30gQ3VycmVudCBjb250ZW50IG9mIFNpbXVsYXRvciBwYXN0ZWJvYXJkIG9yIGFuIGVtcHR5IHN0cmluZy5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgY29ycmVzcG9uZGluZyBzaW1jdGwgc3ViY29tbWFuZCBjb21tYW5kXG4gKiAgICAgICAgICAgICAgICAgcmV0dXJucyBub24temVybyByZXR1cm4gY29kZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0UGFzdGVib2FyZCAodWRpZCwgZW5jb2RpbmcgPSAndXRmLTgnKSB7XG4gIGNvbnN0IGFyZ3MgPSBbJ3NpbWN0bCcsICdwYnBhc3RlJywgdWRpZF07XG4gIHRyeSB7XG4gICAgY29uc3Qge3N0ZG91dH0gPSBhd2FpdCBleGVjKCd4Y3J1bicsIGFyZ3MsIHt0aW1lb3V0OiAwLCBlbmNvZGluZ30pO1xuICAgIHJldHVybiBzdGRvdXQ7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBpZiAoZS5zdGRlcnIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3IgcnVubmluZyAneGNydW4gJHthcmdzLmpvaW4oJyAnKX0nOiAke2Uuc3RkZXJyLnRyaW0oKX1gKTtcbiAgICB9XG4gICAgdGhyb3cgZTtcbiAgfVxufVxuXG4vLyNyZWdpb24gQXBwZWFyYW5jZVxuXG4vKipcbiAqIFJldHJpZXZlcyB0aGUgY3VycmVudCBVSSBhcHBlYXJhbmNlIHZhbHVlIGZyb20gdGhlIGdpdmVuIHNpbXVsYXRvclxuICpcbiAqIEBzaW5jZSBYY29kZSAxMS40IFNES1xuICogQHBhcmFtIHtzdHJpbmd9IHVkaWQgLSBEZXZpY2UgVURJRC5cbiAqIEByZXR1cm4ge3N0cmluZ30gdGhlIGFwcGVhcmFuY2UgdmFsdWUsIGZvciBleGFtcGxlICdsaWdodCcgb3IgJ2RhcmsnXG4gKiBAdGhyb3dzIHtFcnJvcn0gaWYgdGhlIGN1cnJlbnQgU0RLIHZlcnNpb24gZG9lcyBub3Qgc3VwcG9ydCB0aGUgY29tbWFuZFxuICogb3IgdGhlcmUgd2FzIGFuIGVycm9yIHdoaWxlIGdldHRpbmcgdGhlIHZhbHVlXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGdldEFwcGVhcmFuY2UgKHVkaWQpIHtcbiAgY29uc3Qge3N0ZG91dH0gPSBhd2FpdCBzaW1FeGVjKCd1aScsIDAsIFt1ZGlkLCAnYXBwZWFyYW5jZSddLCB7fSwgdHJ1ZSk7XG4gIHJldHVybiAoc3Rkb3V0IHx8ICcnKS50cmltKCk7XG59XG5cbi8qKlxuICogU2V0cyB0aGUgVUkgYXBwZWFyYW5jZSB0byB0aGUgZ2l2ZW4gc3R5bGVcbiAqXG4gKiBAc2luY2UgWGNvZGUgMTEuNCBTREtcbiAqIEBwYXJhbSB7c3RyaW5nfSB1ZGlkIC0gRGV2aWNlIFVESUQuXG4gKiBAcGFyYW0ge3N0cmluZ30gYXBwZWFyYW5jZSB2YWxpZCBhcHBlYXJhbmNlIHZhbHVlLCBmb3IgZXhhbXBsZSAnbGlnaHQnIG9yICdkYXJrJ1xuICogQHRocm93cyB7RXJyb3J9IGlmIHRoZSBjdXJyZW50IFNESyB2ZXJzaW9uIGRvZXMgbm90IHN1cHBvcnQgdGhlIGNvbW1hbmRcbiAqIG9yIHRoZXJlIHdhcyBhbiBlcnJvciB3aGlsZSBnZXR0aW5nIHRoZSB2YWx1ZVxuICovXG5hc3luYyBmdW5jdGlvbiBzZXRBcHBlYXJhbmNlICh1ZGlkLCBhcHBlYXJhbmNlKSB7XG4gIGF3YWl0IHNpbUV4ZWMoJ3VpJywgMCwgW3VkaWQsICdhcHBlYXJhbmNlJywgYXBwZWFyYW5jZV0sIHt9LCB0cnVlKTtcbn1cblxuLy8jZW5kcmVnaW9uXG5cbi8vI3JlZ2lvbiBQcml2YWN5XG5cbi8qKlxuICogR3JhbnRzIHRoZSBnaXZlbiBwZXJtaXNzaW9uIG9uIHRoZSBhcHAgd2l0aCB0aGUgZ2l2ZW4gYnVuZGxlIGlkZW50aWZpZXJcbiAqXG4gKiBAc2luY2UgWGNvZGUgMTEuNCBTREtcbiAqIEBwYXJhbSB7c3RyaW5nfSB1ZGlkIC0gRGV2aWNlIFVESUQuXG4gKiBAcGFyYW0ge3N0cmluZ30gYnVuZGxlSWQgdGhlIGlkZW50aWZpZXIgb2YgdGhlIGFwcGxpY2F0aW9uIHdob3NlXG4gKiBwcml2YWN5IHNldHRpbmdzIGFyZSBnb2luZyB0byBiZSBjaGFuZ2VkXG4gKiBAcGFyYW0ge3N0cmluZ30gcGVybSBvbmUgb2YgcG9zc2libGUgcGVybWlzc2lvbiB2YWx1ZXM6XG4gKiAtIGFsbDogQXBwbHkgdGhlIGFjdGlvbiB0byBhbGwgc2VydmljZXMuXG4gKiAtIGNhbGVuZGFyOiBBbGxvdyBhY2Nlc3MgdG8gY2FsZW5kYXIuXG4gKiAtIGNvbnRhY3RzLWxpbWl0ZWQ6IEFsbG93IGFjY2VzcyB0byBiYXNpYyBjb250YWN0IGluZm8uXG4gKiAtIGNvbnRhY3RzOiBBbGxvdyBhY2Nlc3MgdG8gZnVsbCBjb250YWN0IGRldGFpbHMuXG4gKiAtIGxvY2F0aW9uOiBBbGxvdyBhY2Nlc3MgdG8gbG9jYXRpb24gc2VydmljZXMgd2hlbiBhcHAgaXMgaW4gdXNlLlxuICogLSBsb2NhdGlvbi1hbHdheXM6IEFsbG93IGFjY2VzcyB0byBsb2NhdGlvbiBzZXJ2aWNlcyBhdCBhbGwgdGltZXMuXG4gKiAtIHBob3Rvcy1hZGQ6IEFsbG93IGFkZGluZyBwaG90b3MgdG8gdGhlIHBob3RvIGxpYnJhcnkuXG4gKiAtIHBob3RvczogQWxsb3cgZnVsbCBhY2Nlc3MgdG8gdGhlIHBob3RvIGxpYnJhcnkuXG4gKiAtIG1lZGlhLWxpYnJhcnk6IEFsbG93IGFjY2VzcyB0byB0aGUgbWVkaWEgbGlicmFyeS5cbiAqIC0gbWljcm9waG9uZTogQWxsb3cgYWNjZXNzIHRvIGF1ZGlvIGlucHV0LlxuICogLSBtb3Rpb246IEFsbG93IGFjY2VzcyB0byBtb3Rpb24gYW5kIGZpdG5lc3MgZGF0YS5cbiAqIC0gcmVtaW5kZXJzOiBBbGxvdyBhY2Nlc3MgdG8gcmVtaW5kZXJzLlxuICogLSBzaXJpOiBBbGxvdyB1c2Ugb2YgdGhlIGFwcCB3aXRoIFNpcmkuXG4gKiBAdGhyb3dzIHtFcnJvcn0gaWYgdGhlIGN1cnJlbnQgU0RLIHZlcnNpb24gZG9lcyBub3Qgc3VwcG9ydCB0aGUgY29tbWFuZFxuICogb3IgdGhlcmUgd2FzIGFuIGVycm9yIHdoaWxlIGdyYW50aW5nIHRoZSBwZXJtaXNzaW9uXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGdyYW50UGVybWlzc2lvbiAodWRpZCwgYnVuZGxlSWQsIHBlcm0pIHtcbiAgYXdhaXQgc2ltRXhlYygncHJpdmFjeScsIDAsIFt1ZGlkLCAnZ3JhbnQnLCBwZXJtLCBidW5kbGVJZF0sIHt9LCB0cnVlKTtcbn1cblxuLyoqXG4gKiBSZXZva2VzIHRoZSBnaXZlbiBwZXJtaXNzaW9uIG9uIHRoZSBhcHAgd2l0aCB0aGUgZ2l2ZW4gYnVuZGxlIGlkZW50aWZpZXJcbiAqIGFmdGVyIGl0IGhhcyBiZWVuIGdyYW50ZWRcbiAqXG4gKiBAc2luY2UgWGNvZGUgMTEuNCBTREtcbiAqIEBwYXJhbSB7c3RyaW5nfSB1ZGlkIC0gRGV2aWNlIFVESUQuXG4gKiBAcGFyYW0ge3N0cmluZ30gYnVuZGxlSWQgdGhlIGlkZW50aWZpZXIgb2YgdGhlIGFwcGxpY2F0aW9uIHdob3NlXG4gKiBwcml2YWN5IHNldHRpbmdzIGFyZSBnb2luZyB0byBiZSBjaGFuZ2VkXG4gKiBAcGFyYW0ge3N0cmluZ30gcGVybSBvbmUgb2YgcG9zc2libGUgcGVybWlzc2lvbiB2YWx1ZXMgKHNlZSBgZ3JhbnRQZXJtaXNzaW9uYClcbiAqIEB0aHJvd3Mge0Vycm9yfSBpZiB0aGUgY3VycmVudCBTREsgdmVyc2lvbiBkb2VzIG5vdCBzdXBwb3J0IHRoZSBjb21tYW5kXG4gKiBvciB0aGVyZSB3YXMgYW4gZXJyb3Igd2hpbGUgcmV2b2tpbmcgdGhlIHBlcm1pc3Npb25cbiAqL1xuYXN5bmMgZnVuY3Rpb24gcmV2b2tlUGVybWlzc2lvbiAodWRpZCwgYnVuZGxlSWQsIHBlcm0pIHtcbiAgYXdhaXQgc2ltRXhlYygncHJpdmFjeScsIDAsIFt1ZGlkLCAncmV2b2tlJywgcGVybSwgYnVuZGxlSWRdLCB7fSwgdHJ1ZSk7XG59XG5cbi8qKlxuICogUmVzZXRzIHRoZSBnaXZlbiBwZXJtaXNzaW9uIG9uIHRoZSBhcHAgd2l0aCB0aGUgZ2l2ZW4gYnVuZGxlIGlkZW50aWZpZXJcbiAqIHRvIGl0cyBkZWZhdWx0IHN0YXRlXG4gKlxuICogQHNpbmNlIFhjb2RlIDExLjQgU0RLXG4gKiBAcGFyYW0ge3N0cmluZ30gdWRpZCAtIERldmljZSBVRElELlxuICogQHBhcmFtIHtzdHJpbmd9IGJ1bmRsZUlkIHRoZSBpZGVudGlmaWVyIG9mIHRoZSBhcHBsaWNhdGlvbiB3aG9zZVxuICogcHJpdmFjeSBzZXR0aW5ncyBhcmUgZ29pbmcgdG8gYmUgY2hhbmdlZFxuICogQHBhcmFtIHtzdHJpbmd9IHBlcm0gb25lIG9mIHBvc3NpYmxlIHBlcm1pc3Npb24gdmFsdWVzIChzZWUgYGdyYW50UGVybWlzc2lvbmApXG4gKiBAdGhyb3dzIHtFcnJvcn0gaWYgdGhlIGN1cnJlbnQgU0RLIHZlcnNpb24gZG9lcyBub3Qgc3VwcG9ydCB0aGUgY29tbWFuZFxuICogb3IgdGhlcmUgd2FzIGFuIGVycm9yIHdoaWxlIHJlc2V0dGluZyB0aGUgcGVybWlzc2lvblxuICovXG5hc3luYyBmdW5jdGlvbiByZXNldFBlcm1pc3Npb24gKHVkaWQsIGJ1bmRsZUlkLCBwZXJtKSB7XG4gIGF3YWl0IHNpbUV4ZWMoJ3ByaXZhY3knLCAwLCBbdWRpZCwgJ3Jlc2V0JywgcGVybSwgYnVuZGxlSWRdLCB7fSwgdHJ1ZSk7XG59XG5cbi8vI2VuZHJlZ2lvblxuXG4vLyNyZWdpb24gS2V5Y2hhaW5cblxuLyoqXG4gKiBBZGRzIHRoZSBnaXZlbiBjZXJ0aWZpY2F0ZSB0byB0aGUgVHJ1c3RlZCBSb290IFN0b3JlIG9uIHRoZSBzaW11bGF0b3JcbiAqXG4gKiBAc2luY2UgWGNvZGUgMTEuNCBTREtcbiAqIEBwYXJhbSB7c3RyaW5nfSB1ZGlkIC0gRGV2aWNlIFVESUQuXG4gKiBAcGFyYW0ge3N0cmluZ30gY2VydFBhdGggdGhlIGZ1bGwgcGF0aCB0byBhIHZhbGlkIC5jZXJ0IGZpbGUgY29udGFpbmluZ1xuICogdGhlIGNlcml0ZmljYXRlIGNvbnRlbnRcbiAqIEB0aHJvd3Mge0Vycm9yfSBpZiB0aGUgY3VycmVudCBTREsgdmVyc2lvbiBkb2VzIG5vdCBzdXBwb3J0IHRoZSBjb21tYW5kXG4gKiBvciB0aGVyZSB3YXMgYW4gZXJyb3Igd2hpbGUgYWRkaW5nIHRoZSBjZXJ0aWZpY2F0ZVxuICovXG5hc3luYyBmdW5jdGlvbiBhZGRSb290Q2VydGlmaWNhdGUgKHVkaWQsIGNlcnRQYXRoKSB7XG4gIGF3YWl0IHNpbUV4ZWMoJ2tleWNoYWluJywgMCwgW3VkaWQsICdhZGQtcm9vdC1jZXJ0JywgY2VydFBhdGhdLCB7fSwgdHJ1ZSk7XG59XG5cbi8qKlxuICogQWRkcyB0aGUgZ2l2ZW4gY2VydGlmaWNhdGUgdG8gdGhlIEtleXZoYWluIFN0b3JlIG9uIHRoZSBzaW11bGF0b3JcbiAqXG4gKiBAc2luY2UgWGNvZGUgMTEuNCBTREtcbiAqIEBwYXJhbSB7c3RyaW5nfSB1ZGlkIC0gRGV2aWNlIFVESUQuXG4gKiBAcGFyYW0ge3N0cmluZ30gY2VydFBhdGggdGhlIGZ1bGwgcGF0aCB0byBhIHZhbGlkIC5jZXJ0IGZpbGUgY29udGFpbmluZ1xuICogdGhlIGNlcml0ZmljYXRlIGNvbnRlbnRcbiAqIEB0aHJvd3Mge0Vycm9yfSBpZiB0aGUgY3VycmVudCBTREsgdmVyc2lvbiBkb2VzIG5vdCBzdXBwb3J0IHRoZSBjb21tYW5kXG4gKiBvciB0aGVyZSB3YXMgYW4gZXJyb3Igd2hpbGUgYWRkaW5nIHRoZSBjZXJ0aWZpY2F0ZVxuICovXG5hc3luYyBmdW5jdGlvbiBhZGRDZXJ0aWZpY2F0ZSAodWRpZCwgY2VydFBhdGgpIHtcbiAgYXdhaXQgc2ltRXhlYygna2V5Y2hhaW4nLCAwLCBbdWRpZCwgJ2FkZC1jZXJ0JywgY2VydFBhdGhdLCB7fSwgdHJ1ZSk7XG59XG5cbi8qKlxuICogUmVzZXRzIHRoZSBzaW11bGF0b3Iga2V5Y2hhaW5cbiAqXG4gKiBAc2luY2UgWGNvZGUgMTEuNCBTREtcbiAqIEBwYXJhbSB7c3RyaW5nfSB1ZGlkIC0gRGV2aWNlIFVESUQuXG4gKiBAdGhyb3dzIHtFcnJvcn0gaWYgdGhlIGN1cnJlbnQgU0RLIHZlcnNpb24gZG9lcyBub3Qgc3VwcG9ydCB0aGUgY29tbWFuZFxuICogb3IgdGhlcmUgd2FzIGFuIGVycm9yIHdoaWxlIHJlc2V0dGluZyB0aGUga2V5Y2hhaW5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gcmVzZXRLZXljaGFpbiAodWRpZCkge1xuICBhd2FpdCBzaW1FeGVjKCdrZXljaGFpbicsIDAsIFt1ZGlkLCAncmVzZXQnXSwge30sIHRydWUpO1xufVxuXG4vLyNlbmRyZWdpb25cblxuLy8jcmVnaW9uIEFQTlNcblxuLyoqXG4gKiBTZW5kIGEgc2ltdWxhdGVkIHB1c2ggbm90aWZpY2F0aW9uXG4gKlxuICogQHNpbmNlIFhjb2RlIDExLjQgU0RLXG4gKiBAcGFyYW0ge3N0cmluZ30gdWRpZCAtIERldmljZSBVRElELlxuICogQHBhcmFtIHtPYmplY3R9IGNvbnRlbnQgLSBUaGUgb2JqZWN0IHRoYXQgZGVzY3JpYmVzIEFwcGxlIHB1c2ggbm90aWZpY2F0aW9uIGNvbnRlbnQuXG4gKiBJdCBtdXN0IGNvbnRhaW4gYSB0b3AtbGV2ZWwgXCJTaW11bGF0b3IgVGFyZ2V0IEJ1bmRsZVwiIGtleSB3aXRoIGEgc3RyaW5nIHZhbHVlIG1hdGNoaW5nXG4gKiB0aGUgdGFyZ2V0IGFwcGxpY2F0aW9u4oCYcyBidW5kbGUgaWRlbnRpZmllciBhbmQgXCJhcHNcIiBrZXkgd2l0aCB2YWxpZCBBcHBsZSBQdXNoIE5vdGlmaWNhdGlvbiB2YWx1ZXMuXG4gKiBGb3IgZXhhbXBsZTpcbiAqIHtcbiAqICAgXCJTaW11bGF0b3IgVGFyZ2V0IEJ1bmRsZVwiOiBcImNvbS5hcHBsZS5QcmVmZXJlbmNlc1wiLFxuICogICBcImFwc1wiOiB7XG4gKiAgICAgXCJhbGVydFwiOiBcIlRoaXMgaXMgYSBzaW11bGF0ZWQgbm90aWZpY2F0aW9uIVwiLFxuICogICAgIFwiYmFkZ2VcIjogMyxcbiAqICAgICBcInNvdW5kXCI6IFwiZGVmYXVsdFwiXG4gKiAgIH1cbiAqIH1cbiAqIEB0aHJvd3Mge0Vycm9yfSBpZiB0aGUgY3VycmVudCBTREsgdmVyc2lvbiBkb2VzIG5vdCBzdXBwb3J0IHRoZSBjb21tYW5kXG4gKiBvciB0aGVyZSB3YXMgYW4gZXJyb3Igd2hpbGUgcHVzaGluZyB0aGUgbm90aWZpY2F0aW9uXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHB1c2hOb3RpZmljYXRpb24gKHVkaWQsIGNvbnRlbnQpIHtcbiAgY29uc3QgdG1wUm9vdCA9IGF3YWl0IHRlbXBEaXIub3BlbkRpcigpO1xuICB0cnkge1xuICAgIGNvbnN0IGRzdFBhdGggPSBwYXRoLnJlc29sdmUodG1wUm9vdCwgJ2FwbnMuanNvbicpO1xuICAgIGF3YWl0IGZzLndyaXRlRmlsZShkc3RQYXRoLCBKU09OLnN0cmluZ2lmeShjb250ZW50KSwgJ3V0ZjgnKTtcbiAgICBhd2FpdCBzaW1FeGVjKCdwdXNoJywgMCwgW3VkaWQsIGRzdFBhdGhdLCB7fSwgdHJ1ZSk7XG4gIH0gZmluYWxseSB7XG4gICAgYXdhaXQgZnMucmltcmFmKHRtcFJvb3QpO1xuICB9XG59XG5cbi8vI2VuZHJlZ2lvblxuXG4vKipcbiAqIEdldCB0aGUgbGlzdCBvZiBkZXZpY2UgdHlwZXMgYXZhaWxhYmxlIGluIHRoZSBjdXJyZW50IFhjb2RlIGluc3RhbGxhdGlvblxuICpcbiAqIEByZXR1cm4ge0FycmF5PHN0cmluZz59IExpc3Qgb2YgdGhlIHR5cGVzIG9mIGRldmljZXMgYXZhaWxhYmxlXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIGNvcnJlc3BvbmRpbmcgc2ltY3RsIGNvbW1hbmQgZmFpbHNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0RGV2aWNlVHlwZXMgKCkge1xuICB0cnkge1xuICAgIGNvbnN0IHtzdGRvdXR9ID0gYXdhaXQgc2ltRXhlYygnbGlzdCcsIDAsIFsnZGV2aWNldHlwZXMnLCAnLWonXSk7XG4gICAgLypcbiAgICAgKiBKU09OIHdpbGwgYmUgbGlrZTpcbiAgICAgKiAgIHtcbiAgICAgKiAgICAgXCJkZXZpY2V0eXBlc1wiIDogW1xuICAgICAqICAgICAgIHtcbiAgICAgKiAgICAgICAgIFwibmFtZVwiIDogXCJpUGhvbmUgNHNcIixcbiAgICAgKiAgICAgICAgIFwiaWRlbnRpZmllclwiIDogXCJjb20uYXBwbGUuQ29yZVNpbXVsYXRvci5TaW1EZXZpY2VUeXBlLmlQaG9uZS00c1wiXG4gICAgICogICAgICAgfSxcbiAgICAgKiAgICAgICAuLi5cbiAgICAgKiAgIH1cbiAgICAgKi9cbiAgICBjb25zdCBkZXZpY2VUeXBlcyA9IEpTT04ucGFyc2Uoc3Rkb3V0LnRyaW0oKSk7XG4gICAgcmV0dXJuIGRldmljZVR5cGVzLmRldmljZXR5cGVzLm1hcCgodHlwZSkgPT4gdHlwZS5uYW1lKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgbGV0IG1zZyA9IGBVbmFibGUgdG8gZ2V0IGxpc3Qgb2YgZGV2aWNlIHR5cGVzOiAke2Vyci5tZXNzYWdlfWA7XG4gICAgaWYgKGVyci5zdGRlcnIpIHtcbiAgICAgIG1zZyA9IGAke21zZ30uIFN0ZGVycjogJHtlcnIuc3RkZXJyfWA7XG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcihtc2cpO1xuICB9XG59XG5cblxuLyoqXG4gKiBHZXQgdGhlIGZ1bGwgbGlzdCBvZiBydW50aW1lcywgZGV2aWNldHlwZXMsIGRldmljZXMgYW5kIHBhaXJzIGFzIE9iamVjdFxuICpcbiAqIEByZXR1cm4ge09iamVjdH0gT2JqZWN0IGNvbnRhaW5pbmcgZGV2aWNlIHR5cGVzLCBydW50aW1lcyBkZXZpY2VzIGFuZCBwYWlyc1xuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBjb3JyZXNwb25kaW5nIHNpbWN0bCBjb21tYW5kIGZhaWxzXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGdldFNpbWN0bExpc3QgKCkge1xuICB0cnkge1xuICAgIGNvbnN0IHtzdGRvdXR9ID0gYXdhaXQgc2ltRXhlYygnbGlzdCcsIDAsIFsnLWonXSk7XG4gICAgLypcbiAgICAgKiBKU09OIHdpbGwgYmUgbGlrZVxuICAgICAqICAge1xuICAgICAqICAgICBcImRldmljZXR5cGVzXCIgOiBbXG4gICAgICogICAgICAge1xuICAgICAqICAgICAgICAgXCJuYW1lXCIgOiBcImlQaG9uZSA0c1wiLFxuICAgICAqICAgICAgICAgXCJpZGVudGlmaWVyXCIgOiBcImNvbS5hcHBsZS5Db3JlU2ltdWxhdG9yLlNpbURldmljZVR5cGUuaVBob25lLTRzXCJcbiAgICAgKiAgICAgICB9LFxuICAgICAqICAgICAgIC4uLlxuICAgICAqICAgICAgXSxcbiAgICAgKiAgICAgXCJydW50aW1lc1wiIDogW1xuICAgICAqICAgICAgIHtcbiAgICAgKiAgICAgICAgIFwidmVyc2lvblwiIDogJzEzLjAnLFxuICAgICAqICAgICAgICAgXCJidW5kbGVQYXRoXCIgOiAnL0FwcGxpY2F0aW9ucy9YY29kZTExYmV0YTQuYXBwL0NvbnRlbnRzL0RldmVsb3Blci9QbGF0Zm9ybXMvaVBob25lT1MucGxhdGZvcm0vTGlicmFyeS9EZXZlbG9wZXIvQ29yZVNpbXVsYXRvci9Qcm9maWxlcy9SdW50aW1lcy9pT1Muc2ltcnVudGltZScsXG4gICAgICogICAgICAgICBcImlzQXZhaWxhYmxlXCIgOiB0cnVlLFxuICAgICAqICAgICAgICAgXCJuYW1lXCIgOiAnaU9TIDEzLjAnLFxuICAgICAqICAgICAgICAgXCJpZGVudGlmaWVyXCIgOiAnY29tLmFwcGxlLkNvcmVTaW11bGF0b3IuU2ltUnVudGltZS5pT1MtMTMtMCcsXG4gICAgICogICAgICAgICBcImJ1aWxkdmVyc2lvblwiIDogJzE3QTU1MzRkJ1xuICAgICAqICAgICAgIH0sXG4gICAgICogICAgICAgLi4uXG4gICAgICogICAgICB9LFxuICAgICAqICAgICBcImRldmljZXNcIiA6XG4gICAgICogICAgICAge1xuICAgICAqICAgICAgICAgJ2NvbS5hcHBsZS5Db3JlU2ltdWxhdG9yLlNpbVJ1bnRpbWUuaU9TLTEzLTAnOiBbIFtPYmplY3RdLCBbT2JqZWN0XSBdIH0sXG4gICAgICogICAgICAgICAuLi5cbiAgICAgKiAgICAgICB9LFxuICAgICAqICAgICBcInBhaXJzXCIgOiB7fSB9XG4gICAgICpcbiAgICAgKiAgIH1cbiAgICAgKi9cbiAgICByZXR1cm4gSlNPTi5wYXJzZShzdGRvdXQpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBsZXQgbXNnID0gYFVuYWJsZSB0byBnZXQgc2ltY3RsIGxpc3Q6ICR7ZXJyLm1lc3NhZ2V9YDtcbiAgICBpZiAoZXJyLnN0ZGVycikge1xuICAgICAgbXNnID0gYCR7bXNnfS4gU3RkZXJyOiAke2Vyci5zdGRlcnJ9YDtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKG1zZyk7XG4gIH1cbn1cblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBCb290TW9uaXRvck9wdGlvbnNcbiAqIEBwcm9wZXJ0eSB7P251bWJlcn0gdGltZW91dCBbMjQwMDAwXSAtIFNpbXVsYXRvciBib290aW5nIHRpbWVvdXQgaW4gbXMuXG4gKiBAcHJvcGVydHkgez9GdW5jdGlvbn0gb25XYWl0aW5nRGF0YU1pZ3JhdGlvbiAtIFRoaXMgZXZlbnQgaXMgZmlyZWQgd2hlbiBkYXRhIG1pZ3JhdGlvbiBzdGFnZSBzdGFydHMuXG4gKiBAcHJvcGVydHkgez9GdW5jdGlvbn0gb25XYWl0aW5nU3lzdGVtQXBwIC0gVGhpcyBldmVudCBpcyBmaXJlZCB3aGVuIHN5c3RlbSBhcHAgd2FpdCBzdGFnZSBzdGFydHMuXG4gKiBAcHJvcGVydHkgez9GdW5jdGlvbn0gb25GaW5pc2hlZCAtIFRoaXMgZXZlbnQgaXMgZmlyZWQgd2hlbiBTaW11bGF0b3IgaXMgZnVsbHkgYm9vdGVkLlxuICogQHByb3BlcnR5IHs/RnVuY3Rpb259IG9uRXJyb3IgLSBUaGlzIGV2ZW50IGlzIGZpcmVkIHdoZW4gdGhlcmUgd2FzIGFuIGVycm9yIHdoaWxlIG1vbml0b3JpbmcgdGhlIGJvb3RpbmcgcHJvY2Vzc1xuICogb3Igd2hlbiB0aGUgdGltZW91dCBoYXMgZXhwaXJlZC5cbiAqL1xuXG4vKipcbiAqIFN0YXJ0IG1vbml0b3JpbmcgZm9yIGJvb3Qgc3RhdHVzIG9mIHRoZSBwYXJ0aWN1bGFyIFNpbXVsYXRvci5cbiAqIElmIG9uRmluaXNoZWQgcHJvcGVydHkgaXMgbm90IHNldCB0aGVuIHRoZSBtZXRob2Qgd2lsbCBibG9ja1xuICogdW50aWwgU2ltdWxhdG9yIGJvb3RpbmcgaXMgY29tcGxldGVkLlxuICogVGhlIG1ldGhvZCBpcyBvbmx5IGF2YWlsYWJsZSBzaW5jZSBYY29kZTguXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVkaWQgLSBEZXZpY2UgVURJRC5cbiAqIEBwYXJhbSB7P0Jvb3RNb25pdG9yT3B0aW9uc30gb3B0cyAtIE1vbml0b3Jpbmcgb3B0aW9ucy5cbiAqIEByZXR1cm5zIHtTdWJQcm9jZXNzfSBUaGUgaW5zdGFuY2Ugb2YgdGhlIGNvcnJlc3BvbmRpbmcgbW9uaXRvcmluZyBwcm9jZXNzLlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBTaW11bGF0b3IgZmFpbHMgdG8gZmluaXNoIGJvb3Rpbmcgd2l0aGluIHRoZSBnaXZlbiB0aW1lb3V0IGFuZCBvbkZpbmlzaGVkXG4gKiBwcm9wZXJ0eSBpcyBub3Qgc2V0LlxuICovXG5hc3luYyBmdW5jdGlvbiBzdGFydEJvb3RNb25pdG9yICh1ZGlkLCBvcHRzID0ge30pIHtcbiAgY29uc3Qge1xuICAgIHRpbWVvdXQgPSAyNDAwMDAsXG4gICAgb25XYWl0aW5nRGF0YU1pZ3JhdGlvbixcbiAgICBvbldhaXRpbmdTeXN0ZW1BcHAsXG4gICAgb25GaW5pc2hlZCxcbiAgICBvbkVycm9yLFxuICB9ID0gb3B0cztcblxuICBsZXQgc3RhdHVzID0gJyc7XG4gIGxldCBpc0Jvb3RpbmdGaW5pc2hlZCA9IGZhbHNlO1xuICBsZXQgZXJyb3IgPSBudWxsO1xuICBsZXQgdGltZW91dEhhbmRsZXIgPSBudWxsO1xuICBjb25zdCBib290TW9uaXRvciA9IGF3YWl0IHNpbVN1YlByb2Nlc3MoJ2Jvb3RzdGF0dXMnLCAwLCBbdWRpZF0pO1xuICBib290TW9uaXRvci5vbignb3V0cHV0JywgKHN0ZG91dCwgc3RkZXJyKSA9PiB7XG4gICAgc3RhdHVzICs9IHN0ZG91dCB8fCBzdGRlcnI7XG4gICAgaWYgKHN0ZG91dCkge1xuICAgICAgaWYgKHN0ZG91dC5pbmNsdWRlcygnV2FpdGluZyBvbiBEYXRhIE1pZ3JhdGlvbicpICYmIG9uV2FpdGluZ0RhdGFNaWdyYXRpb24pIHtcbiAgICAgICAgb25XYWl0aW5nRGF0YU1pZ3JhdGlvbigpO1xuICAgICAgfSBlbHNlIGlmIChzdGRvdXQuaW5jbHVkZXMoJ1dhaXRpbmcgb24gU3lzdGVtIEFwcCcpICYmIG9uV2FpdGluZ1N5c3RlbUFwcCkge1xuICAgICAgICBvbldhaXRpbmdTeXN0ZW1BcHAoKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICBib290TW9uaXRvci5vbignZXhpdCcsIChjb2RlLCBzaWduYWwpID0+IHtcbiAgICBpZiAodGltZW91dEhhbmRsZXIpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SGFuZGxlcik7XG4gICAgfVxuICAgIGlmIChjb2RlID09PSAwKSB7XG4gICAgICBpZiAob25GaW5pc2hlZCkge1xuICAgICAgICBvbkZpbmlzaGVkKCk7XG4gICAgICB9XG4gICAgICBpc0Jvb3RpbmdGaW5pc2hlZCA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0YXR1cyA9IHN0YXR1cyB8fCBzaWduYWw7XG4gICAgICBlcnJvciA9IG5ldyBFcnJvcihzdGF0dXMpO1xuICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgb25FcnJvcihlcnJvcik7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbiAgYXdhaXQgYm9vdE1vbml0b3Iuc3RhcnQoMCk7XG4gIGNvbnN0IHN0b3BNb25pdG9yID0gYXN5bmMgKCkgPT4ge1xuICAgIGlmIChib290TW9uaXRvci5pc1J1bm5pbmcpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IGJvb3RNb25pdG9yLnN0b3AoKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgbG9nLndhcm4oZS5tZXNzYWdlKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG4gIGNvbnN0IHRpbWVyID0gbmV3IHRpbWluZy5UaW1lcigpLnN0YXJ0KCk7XG4gIGlmIChvbkZpbmlzaGVkKSB7XG4gICAgdGltZW91dEhhbmRsZXIgPSBzZXRUaW1lb3V0KHN0b3BNb25pdG9yLCB0aW1lb3V0KTtcbiAgfSBlbHNlIHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgd2FpdEZvckNvbmRpdGlvbigoKSA9PiB7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpc0Jvb3RpbmdGaW5pc2hlZDtcbiAgICAgIH0sIHt3YWl0TXM6IHRpbWVvdXQsIGludGVydmFsTXM6IDUwMH0pO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgYXdhaXQgc3RvcE1vbml0b3IoKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVGhlIHNpbXVsYXRvciAke3VkaWR9IGhhcyBmYWlsZWQgdG8gZmluaXNoIGJvb3RpbmcgYWZ0ZXIgJHt0aW1lci5nZXREdXJhdGlvbigpLmFzU2Vjb25kcy50b0ZpeGVkKDMpfXMuIGAgK1xuICAgICAgICBgT3JpZ2luYWwgc3RhdHVzOiAke3N0YXR1c31gKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGJvb3RNb25pdG9yO1xufVxuXG5cbmV4cG9ydCB7XG4gIGluc3RhbGxBcHAsIHJlbW92ZUFwcCwgbGF1bmNoLCBzcGF3biwgc3Bhd25TdWJQcm9jZXNzLCBvcGVuVXJsLCB0ZXJtaW5hdGUsXG4gIHNodXRkb3duLCBjcmVhdGVEZXZpY2UsIGdldEFwcENvbnRhaW5lciwgZ2V0U2NyZWVuc2hvdCwgZGVsZXRlRGV2aWNlLFxuICBlcmFzZURldmljZSwgZ2V0RGV2aWNlcywgZ2V0UnVudGltZUZvclBsYXRmb3JtVmVyc2lvbiwgYm9vdERldmljZSxcbiAgc2V0UGFzdGVib2FyZCwgZ2V0UGFzdGVib2FyZCwgYWRkTWVkaWEsIGFwcEluZm8sIGdldERldmljZVR5cGVzLFxuICBzdGFydEJvb3RNb25pdG9yLCBnZXRTaW1jdGxMaXN0LCBub3JtYWxpemVWZXJzaW9uLFxuICBnZXRBcHBlYXJhbmNlLCBzZXRBcHBlYXJhbmNlLFxuICBncmFudFBlcm1pc3Npb24sIHJldm9rZVBlcm1pc3Npb24sIHJlc2V0UGVybWlzc2lvbixcbiAgYWRkUm9vdENlcnRpZmljYXRlLCBhZGRDZXJ0aWZpY2F0ZSwgcmVzZXRLZXljaGFpbixcbiAgcHVzaE5vdGlmaWNhdGlvbixcbn07XG4iXSwiZmlsZSI6ImxpYi9zaW1jdGwuanMiLCJzb3VyY2VSb290IjoiLi4vLi4ifQ==
